(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    207327,       4651]
NotebookOptionsPosition[    205954,       4602]
NotebookOutlinePosition[    206318,       4618]
CellTagsIndexPosition[    206275,       4615]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Gerik Zatorski
ME 454 Final\
\>", "Title",
 CellChangeTimes->{{3.690218140167184*^9, 3.690218145252961*^9}, 
   3.690218288931326*^9, {3.6960064817682734`*^9, 3.696006499765436*^9}, {
   3.6960081399478817`*^9, 3.696008141647971*^9}, {3.696568065511221*^9, 
   3.6965680656621428`*^9}, {3.705970232531652*^9, 3.705970238927997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.690218149756562*^9, 3.690218153983665*^9}, 
   3.696006985964861*^9, {3.69600718677421*^9, 3.6960072609860163`*^9}, {
   3.7059514896713247`*^9, 3.7059515025756893`*^9}, {3.705970244090686*^9, 
   3.705970245039983*^9}}],

Cell[CellGroupData[{

Cell["Stage 1 - Ball is stuck to hand", "Section",
 CellChangeTimes->{{3.6902182917834167`*^9, 3.690218302014227*^9}, 
   3.690225387331921*^9, 3.690225431291205*^9, {3.690226325684214*^9, 
   3.690226328296939*^9}, {3.705971083805937*^9, 3.7059710954648457`*^9}, {
   3.705971178504891*^9, 3.705971179044775*^9}, {3.70597125013477*^9, 
   3.705971252607601*^9}, {3.705977084534083*^9, 3.70597708630231*^9}, {
   3.705996475471546*^9, 3.705996476861188*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "**********************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Helper", " ", "Functions"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "**********************************************)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"SE", 
    RowBox[{"(", "2", ")"}], " ", "representation", " ", "of", " ", "rigid", 
    " ", "body", " ", "motion", " ", "in", " ", "the", " ", "plane"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"g", "[", 
     RowBox[{"x_", ",", "y_", ",", "\[Theta]_"}], "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "x"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "unhat", " ", "takes", " ", "a", " ", "3", "x3", " ", "matrix", " ", 
    "that", " ", "is", " ", "assumed", " ", "to", " ", "be", " ", 
    RowBox[{"ginv", ".", "gdot"}], " ", "for", " ", "SE", 
    RowBox[{"(", "2", ")"}], " ", "and", " ", "returns", " ", "a", " ", "3", 
    "x1", " ", 
    RowBox[{"vector", ".", " ", "The"}], " ", "first", " ", "two", " ", 
    "components", " ", "are", " ", "the", " ", "linear", " ", "velocities", 
    " ", "in", " ", "x", " ", "and", " ", "y", " ", "and", " ", "the", " ", 
    "third", " ", "component", " ", "is", " ", "the", " ", "angular", " ", 
    "velocity", " ", 
    RowBox[{"(", 
     RowBox[{
     "around", " ", "the", " ", "\"\<z\>\"", " ", "axis", " ", "that", " ", 
      "is", " ", "out", " ", "of", " ", "the", " ", "plane", " ", "of", " ", 
      "motion"}], " "}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"unhat", "[", "a_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"a", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"a", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"hat", "[", "]"}], " ", "takes", " ", "a", " ", "3", "x1", " ", 
    "vector", " ", "and", " ", "creates", " ", "a", " ", "3", "x3", " ", 
    "matrix"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hat", "[", "a_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"a", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{"a", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
        RowBox[{"a", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Hom", "[", "]"}], " ", "takes", " ", "a", " ", "point", " ", 
    "in", " ", "the", " ", "plane", " ", "and", " ", "adds", " ", "a", " ", 
    "1", " ", "to", " ", "the", " ", "end", " ", "of", " ", "it", " ", "to", 
    " ", "create", " ", "a", " ", "homogeneous", " ", "representation", " ", 
    "of", " ", "that", " ", 
    RowBox[{"point", ".", " ", "This"}], " ", "is", " ", "used", " ", "for", 
    " ", "animation"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Hom", "[", "pt_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"pt", ",", "1"}], "}"}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"UnHom", "[", "]"}], " ", "takes", " ", "a", " ", "homogeneous", 
    " ", "representation", " ", "of", " ", "a", " ", "point", " ", "and", " ",
     "returns", " ", "the", " ", "point", " ", "in", " ", "the", " ", "plane",
     " ", "by", " ", "removing", " ", "the", " ", "1", " ", "at", " ", "the", 
    " ", "end"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UnHom", "[", "pt_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pt", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"pt", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Distance", " ", "between", " ", "two", " ", "points", " ", "in", " ", "2",
     "D", " ", "plane"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Distance2D", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"y", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", 
         RowBox[{"y", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", "2"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"useful", " ", "for", " ", "debugging"}], " ", "..."}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headlist", "=", 
   RowBox[{"{", 
    RowBox[{
    "Or", ",", "And", ",", "Equal", ",", "Unequal", ",", "Less", ",", 
     "LessEqual", ",", "Greater", ",", "GreaterEqual", ",", "Inequality"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"getAllVariables", "[", 
   RowBox[{"f_", "?", "NumericQ"}], "]"}], ":=", 
  RowBox[{"Sequence", "[", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"getAllVariables", "[", 
   RowBox[{"{", "}"}], "]"}], ":=", 
  RowBox[{"Sequence", "[", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getAllVariables", "[", "t_", "]"}], "/;", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"headlist", ",", "t"}], "]"}]}], ":=", 
  RowBox[{"Sequence", "[", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"getAllVariables", "[", "ll_List", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Union", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"getAllVariables", "[", "#", "]"}], "&"}], ",", "ll"}], "]"}], 
    "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"getAllVariables", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", "n_Integer", "]"}], "[", "f_", "]"}], "[", 
    "arg__", "]"}], "]"}], ":=", 
  RowBox[{"getAllVariables", "[", 
   RowBox[{"{", "arg", "}"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"getAllVariables", "[", 
   RowBox[{"f_Symbol", "[", "arg__", "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fvars", "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Attributes", "[", "f", "]"}], ",", "NumericFunction"}], 
         "]"}], "||", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"headlist", ",", "f"}], "]"}]}], ",", 
       RowBox[{"fvars", "=", 
        RowBox[{"getAllVariables", "[", 
         RowBox[{"{", "arg", "}"}], "]"}]}], ",", 
       RowBox[{"(*", "else", "*)"}], 
       RowBox[{"fvars", "=", 
        RowBox[{"f", "[", "arg", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
      "fvars"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"getAllVariables", "[", "other_", "]"}], ":=", 
  "other"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extractVariables", "[", "formula_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pat", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"_Symbol", "[", "___", "]"}], "[", "___", "]"}], "|", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"_Symbol", ",", "__"}], "]"}], "[", "___", "]"}], "|", 
        RowBox[{"Subscript", "[", 
         RowBox[{"_Symbol", ",", "__"}], "]"}], "|", "_Symbol"}]}], "}"}], 
     ",", 
     RowBox[{"Union", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{"formula", ",", "pat", ",", 
        RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "**********************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Problem", " ", "Setup"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "**********************************************)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Constants", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FtToM", "=", "0.3048"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "0.625"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"diameterBall", "=", 
   RowBox[{
    RowBox[{"9.55", "/", "12"}], "*", "FtToM"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rball", "=", 
   RowBox[{"diameterBall", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tMax", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Robot", " ", "Link", " ", "Lengths", " ", "Constants"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Lhand", "=", 
    RowBox[{"0.3048", "*", 
     RowBox[{"8.5", "/", "12"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "**********************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Frame", " ", "Transformations"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "**********************************************)"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "World", " ", "to", " ", "Joint", " ", "Frame", " ", "Transformations"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gwrist", "=", 
   RowBox[{
    RowBox[{"g", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], ".", 
    RowBox[{"g", "[", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"\[Theta]wrist", "[", "t", "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ghand", "=", 
   RowBox[{"gwrist", ".", 
    RowBox[{"g", "[", 
     RowBox[{
      RowBox[{"Lhand", "/", "2"}], ",", "0", ",", "0"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gfingertip", "=", 
    RowBox[{"gwrist", ".", 
     RowBox[{"g", "[", 
      RowBox[{"Lhand", ",", "0", ",", "0"}], "]"}], ".", 
     RowBox[{"g", "[", 
      RowBox[{"0", ",", "0", ",", "0"}], "]"}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "World", " ", "to", " ", "Ball", " ", "Frame", " ", "Transformations", " ",
     "prior", " ", "to", " ", "roll"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gballbefore", "=", 
   RowBox[{"gwrist", ".", 
    RowBox[{"g", "[", 
     RowBox[{
      RowBox[{"Lhand", "/", "2"}], ",", 
      RowBox[{"-", "rball"}], ",", "0"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gline1before", "=", 
   RowBox[{"gballbefore", ".", 
    RowBox[{"g", "[", 
     RowBox[{
      RowBox[{"-", "rball"}], ",", "0", ",", "0"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gline2before", "=", 
    RowBox[{"gballbefore", ".", 
     RowBox[{"g", "[", 
      RowBox[{"rball", ",", "0", ",", "0"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "**********************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Joint", " ", "Velocity", " ", "Trajectories"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "**********************************************)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]wristsol", "=", 
    RowBox[{
     RowBox[{"ListInterpolation", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Pi", "*", 
          RowBox[{"182", "/", "180"}]}], ",", 
         RowBox[{"Pi", "*", 
          RowBox[{"180", "/", "180"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "tMax"}], "}"}]}], "]"}], "[", "t", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Theta]wristsol", "=", 
     RowBox[{
      RowBox[{"ListInterpolation", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Pi", "*", 
           RowBox[{"21", "/", "16"}]}], ",", 
          RowBox[{"Pi", "*", 
           RowBox[{"21", "/", "16"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "tMax"}], "}"}]}], "]"}], "[", "t", "]"}]}], ";"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\[Theta]wristsol", "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "t", "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], "*", 
            RowBox[{"Sin", "[", "t", "]"}]}], "+", 
           RowBox[{"Pi", "*", 
            RowBox[{"21", "/", "16"}]}]}], ",", 
          RowBox[{"-", 
           RowBox[{"Cos", "[", "t", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "2", ",", "0.05"}], "}"}]}], "]"}], 
      "]"}], "[", "t", "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]wristdotsol", "=", 
   RowBox[{"D", "[", 
    RowBox[{"\[Theta]wristsol", ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]wristdotdotsol", "=", 
    RowBox[{"D", "[", 
     RowBox[{"\[Theta]wristdotsol", ",", "t"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"gotta", " ", "do", " ", "this"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]wrist", "[", "t", "]"}], "=", "\[Theta]wristsol"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]wrist", "'"}], "[", "t", "]"}], "=", 
   "\[Theta]wristdotsol"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]wrist", "''"}], "[", "t", "]"}], "=", 
    "\[Theta]wristdotdotsol"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "**********************************************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Plots", " ", "and", " ", "Animation"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "**********************************************)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordwrist", "[", "time_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"gwrist", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"gwrist", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ")"}], "/.", 
    RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordfingertip", "[", "time_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"gfingertip", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"gfingertip", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
        "\[Theta]wristsol"}], "}"}]}], ")"}], "/.", 
    RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordballbefore", "[", "time_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"gballbefore", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"gballbefore", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
        "\[Theta]wristsol"}], "}"}]}], ")"}], "/.", 
    RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordline1before", "[", "time_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"gline1before", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"gline1before", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
        "\[Theta]wristsol"}], "}"}]}], ")"}], "/.", 
    RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coordline2before", "[", "time_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"gline2before", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"gline2before", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
         "\[Theta]wristsol"}], "}"}]}], ")"}], "/.", 
     RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Link", " ", "Graphics"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Graphicshand", "=", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coordwrist", "[", "t", "]"}], ",", 
       RowBox[{"coordfingertip", "[", "t", "]"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Ball", " ", "Graphics"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Graphicsballbefore", " ", "=", " ", 
   RowBox[{"Circle", "[", 
    RowBox[{
     RowBox[{"coordballbefore", "[", "t", "]"}], ",", "rball"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Graphicsballlinebefore", "=", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"coordline1before", "[", "t", "]"}], ",", 
       RowBox[{"coordline2before", "[", "t", "]"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Solving", " ", "for", " ", "conditions", " ", "at", " ", "beginning", " ",
     "of", " ", "roll"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"troll", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr", "=", 
   RowBox[{"gballbefore", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
      "\[Theta]wristsol"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xr", "=", 
   RowBox[{
    RowBox[{"tr", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}], "/.", 
    RowBox[{"t", "\[Rule]", "troll"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yr", "=", 
   RowBox[{
    RowBox[{"tr", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "3"}], "]"}], "]"}], "/.", 
    RowBox[{"t", "\[Rule]", "troll"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]r", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]wrist", "[", "t", "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
        "\[Theta]wristsol"}], "}"}]}], "/.", 
     RowBox[{"t", "\[Rule]", "troll"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Theta]r", "=", 
     RowBox[{"N", "[", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"tr", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";"}], "*)"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"dot", " ", "sol", " ", "estimation"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"tr1", "=", 
     RowBox[{
      RowBox[{"gballbefore", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
         "\[Theta]wristsol"}], "}"}]}], "/.", 
      RowBox[{"t", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"troll", "-", ".01"}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tr2", "=", 
     RowBox[{
      RowBox[{"gballbefore", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
         "\[Theta]wristsol"}], "}"}]}], "/.", 
      RowBox[{"t", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"troll", "+", ".01"}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Theta]rdot", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ArcCos", "[", 
            RowBox[{"tr2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "-", 
           RowBox[{"ArcCos", "[", 
            RowBox[{"tr1", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ")"}], "/", 
         ".02"}], "]"}], "\[IndentingNewLine]", "xrdot"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tr2", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}], "-", 
            RowBox[{"tr1", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}], "/", ".02"}], 
         "]"}], "\[IndentingNewLine]", "yrdot"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tr2", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "3"}], "]"}], "]"}], "-", 
           RowBox[{"tr1", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ")"}], "/", ".02"}], 
        "]"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\[Theta]rdot", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ArcCos", "[", 
           RowBox[{"tr2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "-", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"tr", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ")"}], "/", 
        ".01"}], "]"}], "\[IndentingNewLine]", "xrdot"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tr2", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}], "-", 
           RowBox[{"tr", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}], "/", ".01"}], 
        "]"}], "\[IndentingNewLine]", "yrdot"}], "=", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"tr2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "3"}], "]"}], "]"}], "-", 
          RowBox[{"tr", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ")"}], "/", ".01"}], 
       "]"}]}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"dot", " ", "sol", " ", "exact"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Theta]rdot", "=", 
  RowBox[{"\[Theta]wristdotsol", "/.", 
   RowBox[{"t", "\[Rule]", "troll"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trdot", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"gballbefore", ",", "t"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
        "\[Theta]wristsol"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]wrist", "'"}], "[", "t", "]"}], "\[Rule]", 
        "\[Theta]wristdotsol"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"trdot", "=", 
     RowBox[{"D", "[", 
      RowBox[{"gballbefore", ",", "t"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xrdot", "=", 
   RowBox[{
    RowBox[{"trdot", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}], "/.", 
    RowBox[{"t", "\[Rule]", "troll"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yrdot", "=", 
    RowBox[{
     RowBox[{"trdot", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], "/.", 
     RowBox[{"t", "\[Rule]", "troll"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Plots", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{"\[Theta]wristsol", ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "tMax"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{"\[Theta]wristdotsol", ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "tMax"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Animations", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Black", ",", 
        RowBox[{"Graphicshand", "/.", 
         RowBox[{"t", "\[Rule]", "time"}]}], ",", "\[IndentingNewLine]", 
        "Black", ",", 
        RowBox[{"Graphicsballbefore", "/.", 
         RowBox[{"t", "\[Rule]", "time"}]}], ",", "\[IndentingNewLine]", 
        "Black", ",", 
        RowBox[{"Graphicsballlinebefore", "/.", 
         RowBox[{"t", "\[Rule]", "time"}]}]}], "\[IndentingNewLine]", "}"}], 
      ",", 
      RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"time", ",", "0", ",", "tMax"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AnimationRate", "\[Rule]", "1.0"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.690226330518538*^9, 3.690226337959011*^9}, {
   3.69022851160993*^9, 3.690228639232394*^9}, {3.690228799137568*^9, 
   3.690228802422187*^9}, {3.6902289637737293`*^9, 3.690228991831657*^9}, {
   3.690229027324367*^9, 3.690229132458714*^9}, {3.690229597540131*^9, 
   3.690229643459231*^9}, {3.690229681202714*^9, 3.6902297777613993`*^9}, {
   3.690229808026651*^9, 3.6902298251267138`*^9}, {3.690229867375082*^9, 
   3.690229872510563*^9}, {3.690229934390094*^9, 3.690229947560499*^9}, {
   3.690233586230961*^9, 3.690233591525092*^9}, {3.690234896180702*^9, 
   3.6902348980190353`*^9}, {3.690234979901311*^9, 3.690234998307028*^9}, {
   3.6902363260943737`*^9, 3.6902363865860443`*^9}, {3.69023654766175*^9, 
   3.6902365978099613`*^9}, 3.690236821784639*^9, {3.6902368814673777`*^9, 
   3.6902369455494823`*^9}, {3.690237224258883*^9, 3.69023729728902*^9}, 
   3.690237342732998*^9, {3.69023738281638*^9, 3.69023738507838*^9}, {
   3.6902374349322*^9, 3.690237463033235*^9}, {3.6902375062540693`*^9, 
   3.6902375316130247`*^9}, {3.6902375637991056`*^9, 3.690237564279088*^9}, 
   3.690237599321474*^9, {3.6902376379808483`*^9, 3.690237638904984*^9}, {
   3.690237712907024*^9, 3.690237802489196*^9}, {3.690237840474299*^9, 
   3.690237860658697*^9}, {3.690237961409133*^9, 3.690237971503973*^9}, {
   3.6902380186938047`*^9, 3.690238020724524*^9}, {3.6902381128659077`*^9, 
   3.6902381315400953`*^9}, {3.690238267164662*^9, 3.690238295438661*^9}, {
   3.690238340336403*^9, 3.69023834935623*^9}, {3.69023838823133*^9, 
   3.690238401684949*^9}, {3.690238490444685*^9, 3.690238500477417*^9}, {
   3.6902385486979733`*^9, 3.6902386155209093`*^9}, {3.690238664400736*^9, 
   3.690238694897977*^9}, {3.690238757119247*^9, 3.690238843743347*^9}, {
   3.690238926461905*^9, 3.6902389383104153`*^9}, {3.6902390084960814`*^9, 
   3.690239095778544*^9}, {3.6902391267333097`*^9, 3.690239177399715*^9}, {
   3.690239288625966*^9, 3.690239300171247*^9}, {3.690239432505479*^9, 
   3.6902394365951853`*^9}, {3.6902396884979753`*^9, 
   3.6902397473275623`*^9}, {3.6902397950680943`*^9, 3.690239809854739*^9}, {
   3.690239910100601*^9, 3.690239968184778*^9}, {3.6902400050823812`*^9, 
   3.6902400283852043`*^9}, 3.690241429452533*^9, {3.690241479243297*^9, 
   3.690241595811426*^9}, {3.690241815927215*^9, 3.690241861657979*^9}, {
   3.690241905184951*^9, 3.6902419468706293`*^9}, {3.6902431124612217`*^9, 
   3.69024314769235*^9}, {3.6902431791152363`*^9, 3.690243216717664*^9}, {
   3.690243249355219*^9, 3.6902432545142813`*^9}, {3.6902433173844137`*^9, 
   3.690243322558937*^9}, {3.6902435062629557`*^9, 3.690243564498238*^9}, {
   3.690243598864911*^9, 3.6902436444410048`*^9}, {3.6902437378278427`*^9, 
   3.690243738623172*^9}, {3.6902437980649557`*^9, 3.690243802795031*^9}, {
   3.690243849683353*^9, 3.6902438880745773`*^9}, {3.6902440158563137`*^9, 
   3.690244016927899*^9}, {3.690244629782947*^9, 3.690244783867033*^9}, {
   3.690244837291168*^9, 3.6902450166592207`*^9}, {3.690245058028665*^9, 
   3.6902451052759027`*^9}, {3.6902451400547256`*^9, 3.690245142664106*^9}, {
   3.6902451902353153`*^9, 3.6902452311390247`*^9}, {3.69024533686252*^9, 
   3.6902454913070602`*^9}, {3.690245556586669*^9, 3.6902456391337233`*^9}, {
   3.690245671899815*^9, 3.6902458286156588`*^9}, {3.6902459380102053`*^9, 
   3.6902462431196213`*^9}, {3.690248197528664*^9, 3.690248207761325*^9}, {
   3.690248459957505*^9, 3.690248518104879*^9}, {3.690251700654558*^9, 
   3.690251714906808*^9}, {3.690251854438717*^9, 3.6902518723391533`*^9}, 
   3.690251949454039*^9, {3.690252053603266*^9, 3.690252064771954*^9}, {
   3.690252161093568*^9, 3.6902522084219027`*^9}, {3.690252241729607*^9, 
   3.690252266824362*^9}, {3.69025244518959*^9, 3.690252471638474*^9}, {
   3.690252503225462*^9, 3.690252517905493*^9}, {3.690252570661068*^9, 
   3.690252650769693*^9}, {3.690252754962261*^9, 3.690252767576728*^9}, {
   3.690252959133464*^9, 3.690253004217224*^9}, {3.690253079750716*^9, 
   3.690253103758251*^9}, {3.690253200859767*^9, 3.6902532313116703`*^9}, {
   3.690253265581291*^9, 3.690253265859725*^9}, {3.690253302461061*^9, 
   3.690253305596101*^9}, {3.690253360892684*^9, 3.690253371526573*^9}, {
   3.6902534630584917`*^9, 3.690253465838418*^9}, 3.690253626248384*^9, {
   3.69025371361464*^9, 3.690253757858123*^9}, {3.6902541585682993`*^9, 
   3.6902541988440742`*^9}, {3.690254287043174*^9, 3.6902543031864767`*^9}, 
   3.69025436244582*^9, 3.6902558023260527`*^9, {3.690255845007316*^9, 
   3.690255964153448*^9}, 3.6902560157511044`*^9, {3.690258067759439*^9, 
   3.690258068631134*^9}, {3.690270187717106*^9, 3.69027019165904*^9}, {
   3.6902702238791113`*^9, 3.69027022498446*^9}, {3.690270432932934*^9, 
   3.690270535168994*^9}, {3.6902705793998117`*^9, 3.690270666412376*^9}, 
   3.690270752815062*^9, {3.690270791946003*^9, 3.690270792309555*^9}, {
   3.690270825587813*^9, 3.690270861586526*^9}, {3.6902709325979757`*^9, 
   3.690270935715736*^9}, {3.6902710147161503`*^9, 3.690271015110798*^9}, {
   3.69027166833948*^9, 3.690271668379038*^9}, {3.69027235598958*^9, 
   3.690272356378272*^9}, {3.69027301006188*^9, 3.6902730198327017`*^9}, {
   3.690274525360973*^9, 3.69027456456358*^9}, {3.690274714405197*^9, 
   3.6902747181807756`*^9}, 3.69027779234855*^9, {3.6902779031264467`*^9, 
   3.690277905349608*^9}, {3.6959970826769114`*^9, 3.695997086259396*^9}, 
   3.695997141119047*^9, {3.6959972744291677`*^9, 3.695997275325059*^9}, {
   3.696005451586069*^9, 3.696005530481702*^9}, 3.6960058558999453`*^9, {
   3.69600607335315*^9, 3.6960060747147627`*^9}, 3.6960061643268213`*^9, {
   3.696006578842411*^9, 3.696006712961194*^9}, {3.696006759873337*^9, 
   3.696006778139282*^9}, {3.69600681768647*^9, 3.696006962225985*^9}, {
   3.6960070136344843`*^9, 3.6960070314423*^9}, {3.696007084689372*^9, 
   3.696007134753025*^9}, {3.6960073326698093`*^9, 3.696007347879386*^9}, {
   3.696007417483367*^9, 3.6960074484561768`*^9}, {3.696007489682991*^9, 
   3.696007613815239*^9}, {3.6960076483537073`*^9, 3.696007771975712*^9}, {
   3.696007812079821*^9, 3.6960078262106047`*^9}, {3.696007887697084*^9, 
   3.696007910841385*^9}, {3.696007952080489*^9, 3.6960080418741903`*^9}, {
   3.696008105563127*^9, 3.696008108901091*^9}, {3.696008155722096*^9, 
   3.696008178740094*^9}, {3.6960082476228*^9, 3.6960083062820377`*^9}, {
   3.696008336475698*^9, 3.696008522667015*^9}, 3.696008735862743*^9, {
   3.696008870336152*^9, 3.696008903604568*^9}, 3.696008970064084*^9, {
   3.696009650052535*^9, 3.696009650299122*^9}, {3.696009699816922*^9, 
   3.69600973556914*^9}, {3.696009775318314*^9, 3.696009779160122*^9}, {
   3.696014784531632*^9, 3.696014847767576*^9}, {3.696015401708291*^9, 
   3.6960154452562113`*^9}, {3.696016078417461*^9, 3.6960161054667463`*^9}, {
   3.696017047777637*^9, 3.696017052178722*^9}, {3.696018725966028*^9, 
   3.696018729550816*^9}, {3.6960220983072777`*^9, 3.696022159155649*^9}, {
   3.6960227935584087`*^9, 3.696022794015318*^9}, {3.696022932416236*^9, 
   3.696022940571145*^9}, {3.69602297733524*^9, 3.696023056990942*^9}, {
   3.69602309895872*^9, 3.696023109198831*^9}, {3.696023183697372*^9, 
   3.696023200991782*^9}, {3.696023280597814*^9, 3.696023344736702*^9}, {
   3.696023443270895*^9, 3.696023445779895*^9}, {3.696023477453802*^9, 
   3.6960235077846518`*^9}, {3.696024469171541*^9, 3.6960244983541517`*^9}, {
   3.696024601027158*^9, 3.69602473938136*^9}, {3.69602577072368*^9, 
   3.696025778971692*^9}, {3.696025812112337*^9, 3.696025870129299*^9}, {
   3.696028649079791*^9, 3.696028723628684*^9}, {3.696028759754191*^9, 
   3.696028761192588*^9}, {3.696354140146042*^9, 3.696354198109378*^9}, {
   3.696354246097477*^9, 3.696354253484168*^9}, 3.6963588924071407`*^9, 
   3.696358925490488*^9, {3.6963593029660683`*^9, 3.696359330295179*^9}, {
   3.696362696605871*^9, 3.6963627189297733`*^9}, {3.696363116562438*^9, 
   3.696363119360176*^9}, {3.696363300173724*^9, 3.6963633112952538`*^9}, 
   3.696363465637322*^9, {3.696363504355362*^9, 3.6963635252028646`*^9}, {
   3.6963636366107264`*^9, 3.6963637019751663`*^9}, {3.696363753487035*^9, 
   3.696363794363965*^9}, {3.69636384221992*^9, 3.6963638583584347`*^9}, {
   3.696365788385479*^9, 3.69636585734654*^9}, {3.696367935810224*^9, 
   3.696367945656725*^9}, {3.696367983666568*^9, 3.6963679889628363`*^9}, {
   3.696435819997278*^9, 3.6964358612883387`*^9}, {3.696437021664439*^9, 
   3.696437021818481*^9}, {3.696438227557149*^9, 3.696438261836878*^9}, {
   3.6964382972211647`*^9, 3.696438311165413*^9}, {3.6964383491438932`*^9, 
   3.696438450446825*^9}, {3.696438482127512*^9, 3.69643853347169*^9}, {
   3.69643856610166*^9, 3.696438614081964*^9}, {3.696438825110763*^9, 
   3.69643882522717*^9}, {3.696459407510086*^9, 3.696459413032455*^9}, {
   3.6964617298928223`*^9, 3.6964618284327602`*^9}, {3.696461882371332*^9, 
   3.696461903227255*^9}, {3.696462068986538*^9, 3.6964621042449102`*^9}, {
   3.6964627527014437`*^9, 3.696462850699827*^9}, {3.696462945436558*^9, 
   3.69646297471797*^9}, {3.6964631215018663`*^9, 3.696463125520157*^9}, {
   3.696463269993175*^9, 3.696463271659017*^9}, {3.696463376536697*^9, 
   3.696463446227561*^9}, {3.696463501760091*^9, 3.696463589064781*^9}, {
   3.696463771751664*^9, 3.696463786501009*^9}, {3.696465207387075*^9, 
   3.6964652792961073`*^9}, {3.696467745489732*^9, 3.6964677563139668`*^9}, {
   3.69646793285954*^9, 3.69646793433738*^9}, {3.6964686653977337`*^9, 
   3.696468667407322*^9}, {3.696469011322062*^9, 3.696469020611709*^9}, {
   3.696469080940503*^9, 3.69646909657559*^9}, {3.696470351665249*^9, 
   3.696470368770604*^9}, {3.696470430350938*^9, 3.696470468696601*^9}, {
   3.6964705190271387`*^9, 3.696470580556324*^9}, {3.696470617508884*^9, 
   3.696470664385174*^9}, {3.696470701014954*^9, 3.696470853220087*^9}, {
   3.696470896976212*^9, 3.696470901593244*^9}, {3.69647093781116*^9, 
   3.6964711292962227`*^9}, {3.696471164073613*^9, 3.696471164276476*^9}, {
   3.6964712563952293`*^9, 3.696471288910349*^9}, {3.696471339303316*^9, 
   3.696471364530347*^9}, {3.696471400683695*^9, 3.6964714596983232`*^9}, {
   3.6964714927580557`*^9, 3.696471496647243*^9}, {3.696471539627616*^9, 
   3.6964716416658487`*^9}, {3.696471818134522*^9, 3.6964718422465353`*^9}, {
   3.696472101704905*^9, 3.6964721022854757`*^9}, {3.696472145790749*^9, 
   3.696472206888337*^9}, {3.6964722496081247`*^9, 3.6964722509776173`*^9}, {
   3.6964724295858507`*^9, 3.69647244901792*^9}, {3.696472600015321*^9, 
   3.696472625335142*^9}, {3.6964726738755283`*^9, 3.6964726849879093`*^9}, {
   3.696472729393485*^9, 3.69647276653198*^9}, {3.6964728131817427`*^9, 
   3.696472849332312*^9}, {3.6964729230382957`*^9, 3.6964729419910393`*^9}, {
   3.696474870392412*^9, 3.69647487224333*^9}, 3.696477804226581*^9, {
   3.69647786309818*^9, 3.696477863659927*^9}, {3.6964793937105503`*^9, 
   3.696479446404643*^9}, {3.696479479775807*^9, 3.6964795460974083`*^9}, {
   3.696479615838171*^9, 3.696479808454015*^9}, {3.696479840331389*^9, 
   3.6964798962393913`*^9}, {3.696479939861658*^9, 3.696479943708644*^9}, {
   3.696480255998579*^9, 3.6964802665573874`*^9}, {3.6964803860592012`*^9, 
   3.696480407716989*^9}, {3.696480442403885*^9, 3.696480580385881*^9}, {
   3.696480638024605*^9, 3.6964806601816998`*^9}, {3.696480733485489*^9, 
   3.696480769986637*^9}, {3.696480828125873*^9, 3.696480836133589*^9}, {
   3.696480927805463*^9, 3.696480929735564*^9}, {3.696481280232435*^9, 
   3.696481313680892*^9}, {3.696481352821148*^9, 3.696481382880053*^9}, {
   3.6964814746989813`*^9, 3.696481487970557*^9}, {3.6964815275982428`*^9, 
   3.696481549347951*^9}, {3.696481662023947*^9, 3.6964816689427767`*^9}, {
   3.696481762508068*^9, 3.696481781628169*^9}, {3.696482405664818*^9, 
   3.6964824164283*^9}, {3.696482540624279*^9, 3.696482580163733*^9}, {
   3.696482863899858*^9, 3.696482874237773*^9}, {3.696526510274375*^9, 
   3.696526524542741*^9}, {3.696526937838643*^9, 3.6965269492156897`*^9}, {
   3.696527552237585*^9, 3.696527555918539*^9}, {3.696531177373313*^9, 
   3.6965312429702463`*^9}, {3.696531282012781*^9, 3.696531307828671*^9}, {
   3.696531342049341*^9, 3.6965313622963943`*^9}, {3.696531401297428*^9, 
   3.6965314154177837`*^9}, {3.696531469259343*^9, 3.696531469448001*^9}, {
   3.6965315183778343`*^9, 3.6965315513732033`*^9}, 3.696531678423902*^9, {
   3.696531717820671*^9, 3.696531750945058*^9}, {3.696531784435834*^9, 
   3.696531790842305*^9}, {3.696531830799281*^9, 3.696531887517538*^9}, {
   3.69653304451725*^9, 3.696533055646614*^9}, {3.6965331133032427`*^9, 
   3.696533136882724*^9}, {3.696533184024374*^9, 3.696533190530395*^9}, {
   3.6965348414554377`*^9, 3.696534841640506*^9}, {3.696537097691449*^9, 
   3.6965371250872297`*^9}, {3.696537251188168*^9, 3.696537475942589*^9}, {
   3.6965375879635277`*^9, 3.696537603549708*^9}, {3.6965399562494392`*^9, 
   3.696539960704011*^9}, 3.696540109638998*^9, {3.6965428971345797`*^9, 
   3.6965428973973427`*^9}, {3.69654380457812*^9, 3.696543812544532*^9}, {
   3.696547201658333*^9, 3.696547218399353*^9}, {3.696547437203106*^9, 
   3.6965474523749866`*^9}, {3.6965475562025137`*^9, 3.696547556361558*^9}, {
   3.696547962629673*^9, 3.6965479627741213`*^9}, {3.696569002335808*^9, 
   3.696569034694186*^9}, {3.6965694523070498`*^9, 3.696569452502822*^9}, {
   3.696569600655488*^9, 3.696569600797859*^9}, {3.696655956971352*^9, 
   3.696655957684654*^9}, {3.70595185021354*^9, 3.705951853982918*^9}, {
   3.705959451976565*^9, 3.705959464176798*^9}, {3.705959744272612*^9, 
   3.705959754088088*^9}, {3.705970265370048*^9, 3.705970331428624*^9}, {
   3.7059703803814096`*^9, 3.705970415444294*^9}, {3.7059704513300447`*^9, 
   3.705970479447031*^9}, {3.705971173027087*^9, 3.7059711751800003`*^9}, {
   3.705971341105975*^9, 3.705971359489706*^9}, {3.705971409497601*^9, 
   3.70597141043908*^9}, {3.705971451176136*^9, 3.705971461380632*^9}, {
   3.70597214947618*^9, 3.705972201881258*^9}, {3.705973391332386*^9, 
   3.705973399429324*^9}, {3.705973495285018*^9, 3.705973514660832*^9}, {
   3.705973591118456*^9, 3.705973592541288*^9}, {3.705973867144661*^9, 
   3.705973934373249*^9}, {3.705994050775042*^9, 3.705994088040945*^9}, {
   3.7059941262187347`*^9, 3.705994155749261*^9}, {3.705994233202858*^9, 
   3.705994265720104*^9}, {3.7060005477637157`*^9, 3.70600057572425*^9}, {
   3.7060006243138237`*^9, 3.706000664109317*^9}, {3.706000718270418*^9, 
   3.706000718537437*^9}}],

Cell[BoxData[
 TemplateBox[{
  "ListInterpolation","inhr",
   "\"Requested order is too high; order has been reduced to \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"1\\\", \\\"}\\\"}]\\).\"",2,1169,122,
   32568781220545922687,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.696537604095468*^9, 3.696537634225793*^9, 3.696537681649721*^9, 
   3.696537798969589*^9, 3.696538843738494*^9, 3.69653890979993*^9, 
   3.696538940545041*^9, 3.696539779315011*^9, 3.696539825240799*^9, 
   3.69653989749192*^9, 3.696539961824617*^9, 3.696539998457181*^9, 
   3.696540029625752*^9, 3.6965401106958857`*^9, {3.696541432800722*^9, 
   3.6965414549626207`*^9}, 3.696541535131592*^9, 3.696541717641221*^9, 
   3.6965417887208977`*^9, {3.696542063152042*^9, 3.696542090429637*^9}, 
   3.6965421818159847`*^9, {3.6965423154689283`*^9, 3.696542332520296*^9}, 
   3.696542554303347*^9, 3.696542626964839*^9, {3.696542667596106*^9, 
   3.696542689044301*^9}, 3.696542772167404*^9, 3.696542848869094*^9, 
   3.696542898043941*^9, 3.696543814744204*^9, 3.696543851409594*^9, 
   3.6965439489966373`*^9, 3.696544045767995*^9, {3.696544099162611*^9, 
   3.696544118072406*^9}, 3.6965443934968843`*^9, {3.6965444281679173`*^9, 
   3.696544442305941*^9}, {3.696544476642357*^9, 3.6965444995699167`*^9}, 
   3.6965448863387747`*^9, 3.6965449204226418`*^9, 3.696544993687393*^9, 
   3.696545319809219*^9, 3.696545781189351*^9, 3.696546599102648*^9, 
   3.696547117864702*^9, 3.6965471549908657`*^9, 3.696547219860269*^9, {
   3.696547294087698*^9, 3.6965473090218487`*^9}, 3.696547376107287*^9, 
   3.696547455547411*^9, 3.6965475570028343`*^9, 3.696547963549358*^9, {
   3.696567972959526*^9, 3.696567988757649*^9}, 3.696568204034227*^9, 
   3.6965690564208937`*^9, 3.696569103981254*^9, 3.696569178852746*^9, 
   3.696569222371482*^9, 3.696569361960022*^9, 3.696569454356834*^9, 
   3.6965695901818247`*^9, 3.696569638532145*^9, 3.696569722286911*^9, 
   3.696569862321788*^9, 3.6965699638761387`*^9, 3.6965700698614073`*^9, 
   3.6965701416710176`*^9, 3.696570291527638*^9, 3.696570381388773*^9, 
   3.696570548563048*^9, 3.6965706551452513`*^9, 3.696570759229553*^9, 
   3.696570816408863*^9, {3.696570858328842*^9, 3.696570916158729*^9}, 
   3.696571054631033*^9, 3.6965711091250553`*^9, 3.696571214783155*^9, 
   3.696571258915347*^9, 3.6965713308337317`*^9, 3.696571561638102*^9, 
   3.6965716929928627`*^9, 3.696571820382503*^9, {3.696655208000951*^9, 
   3.6966552267335663`*^9}, 3.696655992388341*^9, 3.696656043800531*^9, 
   3.696656277961564*^9, 3.7059515156979733`*^9, 3.705951590873945*^9, 
   3.7059517168218517`*^9, 3.7059518618989143`*^9, 3.7059552111515083`*^9, 
   3.705956271758129*^9, 3.705958985335917*^9, 3.705968244516341*^9, 
   3.7059695532858553`*^9, 3.705969755804758*^9, 3.7059703532337646`*^9, 
   3.705970490253231*^9, 3.705971000006912*^9, 3.7059710336944733`*^9, 
   3.705971108782735*^9, 3.7059712716945057`*^9, 3.7059713786179447`*^9, 
   3.7059719181015387`*^9, 3.705972053219211*^9, {3.705972218307784*^9, 
   3.7059722449720573`*^9}, 3.7059722941487617`*^9, {3.705972682168704*^9, 
   3.705972703980289*^9}, 3.7059728632916718`*^9, 3.7059729059074097`*^9, 
   3.705973403374292*^9, {3.70597349814209*^9, 3.7059735161596727`*^9}, 
   3.705973594396513*^9, 3.705973674301803*^9, 3.7059737895823717`*^9, 
   3.705973891071217*^9, 3.7059739352709837`*^9, 3.705977044679406*^9, 
   3.705979702159134*^9, 3.705979841387619*^9, 3.705980173017967*^9, 
   3.705980956008862*^9, 3.7059837108707438`*^9, 3.705983854024014*^9, 
   3.7059840133511868`*^9, 3.705984294254528*^9, 3.705984512345273*^9, 
   3.705984839355281*^9, {3.70598791681831*^9, 3.705987920642529*^9}, 
   3.705987953308671*^9, 3.705988823252255*^9, 3.705988871801594*^9, 
   3.705990015980495*^9, 3.705990157835449*^9, 3.705990233226096*^9, 
   3.705990857172522*^9, 3.705991087179038*^9, 3.705991413053584*^9, 
   3.7059915648687563`*^9, 3.705991622315576*^9, 3.705991818381398*^9, 
   3.705991893576173*^9, 3.705992556666504*^9, 3.705992666173501*^9, 
   3.7059927312504873`*^9, 3.705992916466793*^9, 3.705993127099762*^9, 
   3.705993375445198*^9, 3.705993421481779*^9, {3.705993714949836*^9, 
   3.705993739057105*^9}, 3.7059938786641617`*^9, 3.705994003762796*^9, 
   3.705994093189337*^9, {3.70599412998845*^9, 3.705994159437921*^9}, 
   3.705994269272732*^9, 3.705994344163965*^9, 3.705994383797291*^9, 
   3.7059944175789413`*^9, 3.705994719274424*^9, 3.705994783890705*^9, 
   3.705994931947381*^9, 3.705995005949922*^9, 3.705995131282208*^9, 
   3.705995686287589*^9, 3.705996435542815*^9, {3.705996478524309*^9, 
   3.705996507688114*^9}, 3.7059971021950693`*^9, 3.705997173331603*^9, 
   3.705997246819273*^9, 3.7059982932960873`*^9, 3.70599928009684*^9, {
   3.705999837912223*^9, 3.705999861338841*^9}, 3.706000162294527*^9, 
   3.706000312984392*^9, 3.706000576360178*^9, 3.706000630011909*^9, 
   3.706000664680182*^9, 3.706000763048518*^9, 3.706000796757819*^9, {
   3.706001068955061*^9, 3.7060010811836967`*^9}, 3.706001166853188*^9, 
   3.7060013540472507`*^9, 3.706001432223185*^9, 3.706001520880574*^9, 
   3.7060025425599213`*^9, 3.706004400056587*^9, 3.706004480765177*^9, 
   3.70600459698602*^9, 3.706004772998954*^9, 3.7060049509866734`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["\[Pi]", "90"]}]], "Output",
 CellChangeTimes->{{3.6965315300773563`*^9, 3.6965315962108088`*^9}, 
   3.696531646729567*^9, 3.696531680014011*^9, 3.6965317519547043`*^9, 
   3.696531793114656*^9, {3.6965318371315823`*^9, 3.696531888985725*^9}, 
   3.696532824219171*^9, {3.696533102069803*^9, 3.6965331386831827`*^9}, 
   3.696533192114831*^9, 3.696533338936191*^9, 3.6965336279822493`*^9, 
   3.69653404891638*^9, 3.696534203883967*^9, 3.696534309658966*^9, 
   3.696534843099267*^9, {3.6965355184255323`*^9, 3.696535538248932*^9}, 
   3.6965355903211203`*^9, {3.6965356416065607`*^9, 3.696535665090036*^9}, 
   3.696535903336513*^9, 3.696535976308874*^9, 3.696536010806052*^9, 
   3.696536065684609*^9, 3.696536110412003*^9, 3.696536433374323*^9, {
   3.696536469279688*^9, 3.6965364732413607`*^9}, 3.6965365680437727`*^9, 
   3.6965366906167316`*^9, 3.6965368296104717`*^9, 3.696536898207399*^9, 
   3.696537051077476*^9, 3.696537127091845*^9, {3.696537317937583*^9, 
   3.696537328592206*^9}, {3.6965374243721123`*^9, 3.696537498995224*^9}, {
   3.696537591052437*^9, 3.6965376042143*^9}, 3.696537634305717*^9, 
   3.696537681731533*^9, 3.6965377990495243`*^9, 3.696538843846229*^9, 
   3.6965389098814373`*^9, 3.696538940623773*^9, 3.6965397793927317`*^9, 
   3.6965398253283863`*^9, 3.696539897569458*^9, 3.696539961945545*^9, 
   3.696539998537758*^9, 3.69654002970784*^9, 3.696540110762104*^9, {
   3.696541432849471*^9, 3.6965414550020437`*^9}, 3.696541535161705*^9, 
   3.696541717696262*^9, 3.696541788755907*^9, {3.696542063205192*^9, 
   3.696542090482441*^9}, 3.696542181858322*^9, {3.696542315532235*^9, 
   3.696542332567954*^9}, 3.696542554346089*^9, 3.69654262701196*^9, {
   3.696542667656443*^9, 3.6965426891012793`*^9}, 3.696542772214324*^9, 
   3.6965428489409246`*^9, 3.696542898092678*^9, 3.696543814838974*^9, 
   3.69654385151278*^9, 3.6965439491092033`*^9, 3.696544045888966*^9, {
   3.696544099271523*^9, 3.6965441181807003`*^9}, 3.6965443935999823`*^9, {
   3.696544428282263*^9, 3.6965444424190807`*^9}, {3.6965444767501383`*^9, 
   3.6965444996901083`*^9}, 3.696544886436577*^9, 3.696544920541274*^9, 
   3.696544993803665*^9, 3.696545319896871*^9, 3.696545781302799*^9, 
   3.696546599207896*^9, 3.696547117993579*^9, 3.696547155071313*^9, 
   3.696547219916855*^9, {3.6965472941466427`*^9, 3.696547309082158*^9}, 
   3.6965473761665287`*^9, 3.696547455650981*^9, 3.6965475570625257`*^9, 
   3.69654796360539*^9, {3.696567973042037*^9, 3.696567988832099*^9}, 
   3.696568204082795*^9, 3.696569056487072*^9, 3.696569104032612*^9, 
   3.696569178907783*^9, 3.696569222418056*^9, 3.6965693619862223`*^9, 
   3.69656945440998*^9, 3.696569590239862*^9, 3.696569638587345*^9, 
   3.696569722344054*^9, 3.69656986237838*^9, 3.696569963928151*^9, 
   3.696570069922697*^9, 3.696570141731819*^9, 3.6965702915910997`*^9, 
   3.696570381456401*^9, 3.696570548623693*^9, 3.696570655196231*^9, 
   3.696570759288309*^9, 3.696570816474882*^9, {3.696570858394002*^9, 
   3.6965709162280293`*^9}, 3.696571054698348*^9, 3.6965711091887836`*^9, 
   3.6965712148496437`*^9, 3.69657125897127*^9, 3.696571330894562*^9, 
   3.6965715616965027`*^9, 3.696571693056823*^9, 3.69657182043788*^9, {
   3.696655208023489*^9, 3.696655226791985*^9}, 3.6966559924332848`*^9, 
   3.6966560438525877`*^9, 3.69665627802435*^9, 3.7059515157390623`*^9, 
   3.705951590923867*^9, 3.7059517168811417`*^9, 3.70595186194468*^9, 
   3.705955211199381*^9, 3.7059562718047028`*^9, 3.705958985393175*^9, 
   3.705968244575646*^9, 3.705969553331332*^9, 3.705969755847209*^9, 
   3.70597035327426*^9, 3.705970490289521*^9, 3.7059710000499268`*^9, 
   3.705971033706923*^9, 3.705971108822607*^9, 3.7059712717342863`*^9, 
   3.705971378666038*^9, 3.705971918148481*^9, 3.705972053268547*^9, {
   3.705972218344226*^9, 3.705972245012912*^9}, 3.705972294189543*^9, {
   3.705972682205261*^9, 3.7059727040212603`*^9}, 3.705972863328156*^9, 
   3.7059729059478188`*^9, 3.705973403433311*^9, {3.70597349818988*^9, 
   3.7059735162200603`*^9}, 3.705973594460994*^9, 3.705973674343207*^9, 
   3.70597378962846*^9, 3.705973891103304*^9, 3.705973935318056*^9, 
   3.705977044737133*^9, 3.705979702211178*^9, 3.7059798414271708`*^9, 
   3.705980173101869*^9, 3.70598095605276*^9, 3.7059837109511766`*^9, 
   3.705983854071081*^9, 3.705984013405445*^9, 3.705984294303527*^9, 
   3.705984512396351*^9, 3.7059848394030457`*^9, {3.705987916868803*^9, 
   3.705987920709064*^9}, 3.7059879533661613`*^9, 3.705988823297977*^9, 
   3.7059888718373337`*^9, 3.70599001603238*^9, 3.70599015786762*^9, 
   3.705990233269158*^9, 3.705990857198572*^9, 3.705991087239047*^9, 
   3.705991413090621*^9, 3.705991564919867*^9, 3.7059916223626204`*^9, 
   3.7059918184321203`*^9, 3.705991893610175*^9, 3.705992556698241*^9, 
   3.705992666195796*^9, 3.705992731272386*^9, 3.705992916488228*^9, 
   3.7059931271363287`*^9, 3.705993375507599*^9, 3.705993421496903*^9, {
   3.7059937149943666`*^9, 3.7059937391061993`*^9}, 3.705993878693918*^9, 
   3.705994003806273*^9, 3.70599409322523*^9, {3.70599413003857*^9, 
   3.705994159471155*^9}, 3.705994269328837*^9, 3.705994344220442*^9, 
   3.705994383829342*^9, 3.705994417643167*^9, 3.705994719316642*^9, 
   3.7059947839353848`*^9, 3.705994932017803*^9, 3.70599500600667*^9, 
   3.7059951313307123`*^9, 3.705995686329584*^9, 3.705996435584453*^9, {
   3.7059964785494432`*^9, 3.705996507732915*^9}, 3.705997102242079*^9, 
   3.705997173375952*^9, 3.7059972468672943`*^9, 3.705998293343171*^9, 
   3.7059992801418667`*^9, {3.705999837967284*^9, 3.70599986138758*^9}, 
   3.70600016234079*^9, 3.706000313034565*^9, 3.7060005764205236`*^9, 
   3.706000630094162*^9, 3.70600066463111*^9, 3.706000763095245*^9, 
   3.706000796810012*^9, {3.7060010690108852`*^9, 3.7060010812524223`*^9}, 
   3.706001166902426*^9, 3.706001354100169*^9, 3.706001432273562*^9, 
   3.706001520931995*^9, 3.7060025426509323`*^9, 3.70600440010713*^9, 
   3.706004480813656*^9, 3.706004597041257*^9, 3.706004773041234*^9, 
   3.7060049510279493`*^9}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwV0WtUDGgYB/BuTl4dkazM2LJTKaXofiE9L8Wky6qZqBhNum1al9JYWfYk
JnKprDOSmmhELq1SJms1mNWsaNPFTAqZyZhN9xcrnVxq3/3wnOf8vvzPc/4P
K34HJ8lAT08vjM7/Ozipr13ev84/6at0e+YWhI0CmGkahgf82/i4fSe1+7ki
8Q1GIBw42euxjTrkcWdtKSMSztrP/byZOipx7M5JRiI8jdh7OIT65ZLDAXkM
AQRVrCizoi77Zu2howwhOK5taVekIJw99Yb9EYYIRsreeJhRR8dIqt++uwB/
v/+r4VgywiaT2Ty2VTVc70hmfZeE8IKIkb6GY1KYPmEhqU9AeHeLLxR9+APu
qAT9PvEIW0jN1Pr69+AnP5FeWxzCN7UBza1+9+Egh98TxEf4fmrpvJghBRhX
LdU+3ITwqN3yGde2NYKouKs2noewwXjlzHkLmmCXp3WoegPCXpNxN7lVzcDf
vFiaEYNws9Cj5YFjK8ifBPvPjEZ4/onB8SsjbbDr/axf89cjPDimUXe4PAG3
8tJau3UIXxiobzLNV0KggUpcxkXY1PIS0elU0FzBvMLiIHx8S11yme1TiO22
EcrCEf6IK3UpWZ0QIO+y912LsMBNIZ3T0AWunuHFrWEIa6oUx9pZzyEjOqOD
HYrw51RVicPPL8Dpzwq3xmCEF60wnkiu74aR2+LYuDUIs8+zfqixUINhgj/3
BZv2Zcm3fsXTgLX4/Jy01Qg7Da0z6QzrgVtMiy8mqxA2n/F2quJTD0jY3leP
BND/3yupthG/AtEUpj1rJcI/etQ/QyFaeJ5+eWsxRrhyTXzZ3Y9aOG3DVjGB
9jnInNlb+Bpiky9Pq1uOcB2XbSgK1EFmVB1y9UM4KyjnnLRXByXPhJ0PliLM
ehncVZ7zD3hKEhsTfBFe6i0UMdx6wcbibZbWG2GeVeu4vrIXmFb+xnu9aH5T
njYt+w0kKr2jRj0QLjKKFXBs++AW48OuI+70fnXdeQNFHxy8KL9p64bwlF+y
I33T+0Gi8ZFLXBDWuxJbrZ01AA+vZhT5LEF4Z3F13qz7AxBgu8G3xhnhO4ty
p5ptHwTP1+FfXJwQNgve6XTAdAhc3aflNzki3O3cptwjG4Is1x19qxwQvn4W
bHWxw9ApLzR7YY/wpmovM8uJYbh0qoW32w7h/TmS7O6rI/Bobm3aqC3C1/os
S0xDCYw6RXPzbBDOLc2JU39PQO3PMzlMncgZXlAVQaAxPK5hP/W3Mtn1sCgC
xYIUdwH10YKND47HE/CXZZpvpE7xOvNu2h4CuSFnlAuprYWzg4wrCDBTn3MV
1ghP+Oyb3nmZgOE+tcld6mfDr59UVBIYztM2/E59IurGptU1BO7VDLhXUk86
cjJyZAQSxz+Zn6Tubi84a6gkcC13nopPfevQWIKyg0Bh8fzjMdSiZXyH8i4C
Wb/ZBHKpQy4ulq5UE+C0LZKupr6d+fhRdj+BjxZ+ImfqQmfPgoghAhoHHGpP
na4VR7IIgUfLAo1Y1AtDt2rkHwiU8EMFs6mN9FUXTowREKaHO5lS99QtS437
RGDbwUidMbUstXyJy1cC609Fi/WpT883GZ2cJIAv8SI/sxD+D/BuH50=
       "]]},
     Annotation[#, "Charting`Private`Tag$64057#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 3.1415926543021726`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1}, {3.1415926543021726`, 3.1764992379173003`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.6965315300773563`*^9, 3.6965315962108088`*^9}, 
   3.696531646729567*^9, 3.696531680014011*^9, 3.6965317519547043`*^9, 
   3.696531793114656*^9, {3.6965318371315823`*^9, 3.696531888985725*^9}, 
   3.696532824219171*^9, {3.696533102069803*^9, 3.6965331386831827`*^9}, 
   3.696533192114831*^9, 3.696533338936191*^9, 3.6965336279822493`*^9, 
   3.69653404891638*^9, 3.696534203883967*^9, 3.696534309658966*^9, 
   3.696534843099267*^9, {3.6965355184255323`*^9, 3.696535538248932*^9}, 
   3.6965355903211203`*^9, {3.6965356416065607`*^9, 3.696535665090036*^9}, 
   3.696535903336513*^9, 3.696535976308874*^9, 3.696536010806052*^9, 
   3.696536065684609*^9, 3.696536110412003*^9, 3.696536433374323*^9, {
   3.696536469279688*^9, 3.6965364732413607`*^9}, 3.6965365680437727`*^9, 
   3.6965366906167316`*^9, 3.6965368296104717`*^9, 3.696536898207399*^9, 
   3.696537051077476*^9, 3.696537127091845*^9, {3.696537317937583*^9, 
   3.696537328592206*^9}, {3.6965374243721123`*^9, 3.696537498995224*^9}, {
   3.696537591052437*^9, 3.6965376042143*^9}, 3.696537634305717*^9, 
   3.696537681731533*^9, 3.6965377990495243`*^9, 3.696538843846229*^9, 
   3.6965389098814373`*^9, 3.696538940623773*^9, 3.6965397793927317`*^9, 
   3.6965398253283863`*^9, 3.696539897569458*^9, 3.696539961945545*^9, 
   3.696539998537758*^9, 3.69654002970784*^9, 3.696540110762104*^9, {
   3.696541432849471*^9, 3.6965414550020437`*^9}, 3.696541535161705*^9, 
   3.696541717696262*^9, 3.696541788755907*^9, {3.696542063205192*^9, 
   3.696542090482441*^9}, 3.696542181858322*^9, {3.696542315532235*^9, 
   3.696542332567954*^9}, 3.696542554346089*^9, 3.69654262701196*^9, {
   3.696542667656443*^9, 3.6965426891012793`*^9}, 3.696542772214324*^9, 
   3.6965428489409246`*^9, 3.696542898092678*^9, 3.696543814838974*^9, 
   3.69654385151278*^9, 3.6965439491092033`*^9, 3.696544045888966*^9, {
   3.696544099271523*^9, 3.6965441181807003`*^9}, 3.6965443935999823`*^9, {
   3.696544428282263*^9, 3.6965444424190807`*^9}, {3.6965444767501383`*^9, 
   3.6965444996901083`*^9}, 3.696544886436577*^9, 3.696544920541274*^9, 
   3.696544993803665*^9, 3.696545319896871*^9, 3.696545781302799*^9, 
   3.696546599207896*^9, 3.696547117993579*^9, 3.696547155071313*^9, 
   3.696547219916855*^9, {3.6965472941466427`*^9, 3.696547309082158*^9}, 
   3.6965473761665287`*^9, 3.696547455650981*^9, 3.6965475570625257`*^9, 
   3.69654796360539*^9, {3.696567973042037*^9, 3.696567988832099*^9}, 
   3.696568204082795*^9, 3.696569056487072*^9, 3.696569104032612*^9, 
   3.696569178907783*^9, 3.696569222418056*^9, 3.6965693619862223`*^9, 
   3.69656945440998*^9, 3.696569590239862*^9, 3.696569638587345*^9, 
   3.696569722344054*^9, 3.69656986237838*^9, 3.696569963928151*^9, 
   3.696570069922697*^9, 3.696570141731819*^9, 3.6965702915910997`*^9, 
   3.696570381456401*^9, 3.696570548623693*^9, 3.696570655196231*^9, 
   3.696570759288309*^9, 3.696570816474882*^9, {3.696570858394002*^9, 
   3.6965709162280293`*^9}, 3.696571054698348*^9, 3.6965711091887836`*^9, 
   3.6965712148496437`*^9, 3.69657125897127*^9, 3.696571330894562*^9, 
   3.6965715616965027`*^9, 3.696571693056823*^9, 3.69657182043788*^9, {
   3.696655208023489*^9, 3.696655226791985*^9}, 3.6966559924332848`*^9, 
   3.6966560438525877`*^9, 3.69665627802435*^9, 3.7059515157390623`*^9, 
   3.705951590923867*^9, 3.7059517168811417`*^9, 3.70595186194468*^9, 
   3.705955211199381*^9, 3.7059562718047028`*^9, 3.705958985393175*^9, 
   3.705968244575646*^9, 3.705969553331332*^9, 3.705969755847209*^9, 
   3.70597035327426*^9, 3.705970490289521*^9, 3.7059710000499268`*^9, 
   3.705971033706923*^9, 3.705971108822607*^9, 3.7059712717342863`*^9, 
   3.705971378666038*^9, 3.705971918148481*^9, 3.705972053268547*^9, {
   3.705972218344226*^9, 3.705972245012912*^9}, 3.705972294189543*^9, {
   3.705972682205261*^9, 3.7059727040212603`*^9}, 3.705972863328156*^9, 
   3.7059729059478188`*^9, 3.705973403433311*^9, {3.70597349818988*^9, 
   3.7059735162200603`*^9}, 3.705973594460994*^9, 3.705973674343207*^9, 
   3.70597378962846*^9, 3.705973891103304*^9, 3.705973935318056*^9, 
   3.705977044737133*^9, 3.705979702211178*^9, 3.7059798414271708`*^9, 
   3.705980173101869*^9, 3.70598095605276*^9, 3.7059837109511766`*^9, 
   3.705983854071081*^9, 3.705984013405445*^9, 3.705984294303527*^9, 
   3.705984512396351*^9, 3.7059848394030457`*^9, {3.705987916868803*^9, 
   3.705987920709064*^9}, 3.7059879533661613`*^9, 3.705988823297977*^9, 
   3.7059888718373337`*^9, 3.70599001603238*^9, 3.70599015786762*^9, 
   3.705990233269158*^9, 3.705990857198572*^9, 3.705991087239047*^9, 
   3.705991413090621*^9, 3.705991564919867*^9, 3.7059916223626204`*^9, 
   3.7059918184321203`*^9, 3.705991893610175*^9, 3.705992556698241*^9, 
   3.705992666195796*^9, 3.705992731272386*^9, 3.705992916488228*^9, 
   3.7059931271363287`*^9, 3.705993375507599*^9, 3.705993421496903*^9, {
   3.7059937149943666`*^9, 3.7059937391061993`*^9}, 3.705993878693918*^9, 
   3.705994003806273*^9, 3.70599409322523*^9, {3.70599413003857*^9, 
   3.705994159471155*^9}, 3.705994269328837*^9, 3.705994344220442*^9, 
   3.705994383829342*^9, 3.705994417643167*^9, 3.705994719316642*^9, 
   3.7059947839353848`*^9, 3.705994932017803*^9, 3.70599500600667*^9, 
   3.7059951313307123`*^9, 3.705995686329584*^9, 3.705996435584453*^9, {
   3.7059964785494432`*^9, 3.705996507732915*^9}, 3.705997102242079*^9, 
   3.705997173375952*^9, 3.7059972468672943`*^9, 3.705998293343171*^9, 
   3.7059992801418667`*^9, {3.705999837967284*^9, 3.70599986138758*^9}, 
   3.70600016234079*^9, 3.706000313034565*^9, 3.7060005764205236`*^9, 
   3.706000630094162*^9, 3.70600066463111*^9, 3.706000763095245*^9, 
   3.706000796810012*^9, {3.7060010690108852`*^9, 3.7060010812524223`*^9}, 
   3.706001166902426*^9, 3.706001354100169*^9, 3.706001432273562*^9, 
   3.706001520931995*^9, 3.7060025426509323`*^9, 3.70600440010713*^9, 
   3.706004480813656*^9, 3.706004597041257*^9, 3.706004773041234*^9, 
   3.706004951104797*^9}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQ7ZX64uKBl6F2lnODFrndX7h/gah/W5dkiz2M38ix
Wb1TcgqcHxG5cP2Hj0vgfO7/jTHucuvhfNXAdy8Od2+B88vPWdrP+LITzhff
IniPkXE/nL/tkfOZ8zaH4PxDWXOlI98cgfO/qtnyr809Ducz/VwtIK16Cs43
+5+wLXjdGTj/TIvJuWNa5+F8+Qmvf658dwHOf/39/r2rBpfg/CWvdp/i67sM
5/PJLn//5MkVOL8nc2vaApVrcP43h9VPMuqvw/klRke2iB2+AeffX3ek+6Li
LTj/d9aV2ZpVt+F8bUf2f2m778D57osU0zeK30OEl2y80sOY+3C+zptQ7uu+
D+B8Yf4PHEd+Ifgs+2evV57zEM7PNtl9k9P7EZy/2jNpwb5vCP7X11ICz6Y9
hvO3BrszT3F5AufXe7TO3/IMwVe863VjcetTON/KvGWKpNEzOD9G7vxPxssI
/tdTvY8KGp/D+TNY4kqCVF4g3H9v6yKmIwg+a21jiGXhSzifYWXc+kdCr+D8
olnre4UOIfh7tTs4BPNew/mCXkU6TXxv4Pw7uhcuV+5B8DfMs1d5EvcWzo9d
byYo+w/Bb2hd2Hhn1Ts4f+0L2dl8Pu/hfKUWEQ/2ZQj+dHnur///I/gAqwy0
Bw==
       "]]},
     Annotation[#, "Charting`Private`Tag$64095#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1}, {-0.06981317007977318, 0.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.6965315300773563`*^9, 3.6965315962108088`*^9}, 
   3.696531646729567*^9, 3.696531680014011*^9, 3.6965317519547043`*^9, 
   3.696531793114656*^9, {3.6965318371315823`*^9, 3.696531888985725*^9}, 
   3.696532824219171*^9, {3.696533102069803*^9, 3.6965331386831827`*^9}, 
   3.696533192114831*^9, 3.696533338936191*^9, 3.6965336279822493`*^9, 
   3.69653404891638*^9, 3.696534203883967*^9, 3.696534309658966*^9, 
   3.696534843099267*^9, {3.6965355184255323`*^9, 3.696535538248932*^9}, 
   3.6965355903211203`*^9, {3.6965356416065607`*^9, 3.696535665090036*^9}, 
   3.696535903336513*^9, 3.696535976308874*^9, 3.696536010806052*^9, 
   3.696536065684609*^9, 3.696536110412003*^9, 3.696536433374323*^9, {
   3.696536469279688*^9, 3.6965364732413607`*^9}, 3.6965365680437727`*^9, 
   3.6965366906167316`*^9, 3.6965368296104717`*^9, 3.696536898207399*^9, 
   3.696537051077476*^9, 3.696537127091845*^9, {3.696537317937583*^9, 
   3.696537328592206*^9}, {3.6965374243721123`*^9, 3.696537498995224*^9}, {
   3.696537591052437*^9, 3.6965376042143*^9}, 3.696537634305717*^9, 
   3.696537681731533*^9, 3.6965377990495243`*^9, 3.696538843846229*^9, 
   3.6965389098814373`*^9, 3.696538940623773*^9, 3.6965397793927317`*^9, 
   3.6965398253283863`*^9, 3.696539897569458*^9, 3.696539961945545*^9, 
   3.696539998537758*^9, 3.69654002970784*^9, 3.696540110762104*^9, {
   3.696541432849471*^9, 3.6965414550020437`*^9}, 3.696541535161705*^9, 
   3.696541717696262*^9, 3.696541788755907*^9, {3.696542063205192*^9, 
   3.696542090482441*^9}, 3.696542181858322*^9, {3.696542315532235*^9, 
   3.696542332567954*^9}, 3.696542554346089*^9, 3.69654262701196*^9, {
   3.696542667656443*^9, 3.6965426891012793`*^9}, 3.696542772214324*^9, 
   3.6965428489409246`*^9, 3.696542898092678*^9, 3.696543814838974*^9, 
   3.69654385151278*^9, 3.6965439491092033`*^9, 3.696544045888966*^9, {
   3.696544099271523*^9, 3.6965441181807003`*^9}, 3.6965443935999823`*^9, {
   3.696544428282263*^9, 3.6965444424190807`*^9}, {3.6965444767501383`*^9, 
   3.6965444996901083`*^9}, 3.696544886436577*^9, 3.696544920541274*^9, 
   3.696544993803665*^9, 3.696545319896871*^9, 3.696545781302799*^9, 
   3.696546599207896*^9, 3.696547117993579*^9, 3.696547155071313*^9, 
   3.696547219916855*^9, {3.6965472941466427`*^9, 3.696547309082158*^9}, 
   3.6965473761665287`*^9, 3.696547455650981*^9, 3.6965475570625257`*^9, 
   3.69654796360539*^9, {3.696567973042037*^9, 3.696567988832099*^9}, 
   3.696568204082795*^9, 3.696569056487072*^9, 3.696569104032612*^9, 
   3.696569178907783*^9, 3.696569222418056*^9, 3.6965693619862223`*^9, 
   3.69656945440998*^9, 3.696569590239862*^9, 3.696569638587345*^9, 
   3.696569722344054*^9, 3.69656986237838*^9, 3.696569963928151*^9, 
   3.696570069922697*^9, 3.696570141731819*^9, 3.6965702915910997`*^9, 
   3.696570381456401*^9, 3.696570548623693*^9, 3.696570655196231*^9, 
   3.696570759288309*^9, 3.696570816474882*^9, {3.696570858394002*^9, 
   3.6965709162280293`*^9}, 3.696571054698348*^9, 3.6965711091887836`*^9, 
   3.6965712148496437`*^9, 3.69657125897127*^9, 3.696571330894562*^9, 
   3.6965715616965027`*^9, 3.696571693056823*^9, 3.69657182043788*^9, {
   3.696655208023489*^9, 3.696655226791985*^9}, 3.6966559924332848`*^9, 
   3.6966560438525877`*^9, 3.69665627802435*^9, 3.7059515157390623`*^9, 
   3.705951590923867*^9, 3.7059517168811417`*^9, 3.70595186194468*^9, 
   3.705955211199381*^9, 3.7059562718047028`*^9, 3.705958985393175*^9, 
   3.705968244575646*^9, 3.705969553331332*^9, 3.705969755847209*^9, 
   3.70597035327426*^9, 3.705970490289521*^9, 3.7059710000499268`*^9, 
   3.705971033706923*^9, 3.705971108822607*^9, 3.7059712717342863`*^9, 
   3.705971378666038*^9, 3.705971918148481*^9, 3.705972053268547*^9, {
   3.705972218344226*^9, 3.705972245012912*^9}, 3.705972294189543*^9, {
   3.705972682205261*^9, 3.7059727040212603`*^9}, 3.705972863328156*^9, 
   3.7059729059478188`*^9, 3.705973403433311*^9, {3.70597349818988*^9, 
   3.7059735162200603`*^9}, 3.705973594460994*^9, 3.705973674343207*^9, 
   3.70597378962846*^9, 3.705973891103304*^9, 3.705973935318056*^9, 
   3.705977044737133*^9, 3.705979702211178*^9, 3.7059798414271708`*^9, 
   3.705980173101869*^9, 3.70598095605276*^9, 3.7059837109511766`*^9, 
   3.705983854071081*^9, 3.705984013405445*^9, 3.705984294303527*^9, 
   3.705984512396351*^9, 3.7059848394030457`*^9, {3.705987916868803*^9, 
   3.705987920709064*^9}, 3.7059879533661613`*^9, 3.705988823297977*^9, 
   3.7059888718373337`*^9, 3.70599001603238*^9, 3.70599015786762*^9, 
   3.705990233269158*^9, 3.705990857198572*^9, 3.705991087239047*^9, 
   3.705991413090621*^9, 3.705991564919867*^9, 3.7059916223626204`*^9, 
   3.7059918184321203`*^9, 3.705991893610175*^9, 3.705992556698241*^9, 
   3.705992666195796*^9, 3.705992731272386*^9, 3.705992916488228*^9, 
   3.7059931271363287`*^9, 3.705993375507599*^9, 3.705993421496903*^9, {
   3.7059937149943666`*^9, 3.7059937391061993`*^9}, 3.705993878693918*^9, 
   3.705994003806273*^9, 3.70599409322523*^9, {3.70599413003857*^9, 
   3.705994159471155*^9}, 3.705994269328837*^9, 3.705994344220442*^9, 
   3.705994383829342*^9, 3.705994417643167*^9, 3.705994719316642*^9, 
   3.7059947839353848`*^9, 3.705994932017803*^9, 3.70599500600667*^9, 
   3.7059951313307123`*^9, 3.705995686329584*^9, 3.705996435584453*^9, {
   3.7059964785494432`*^9, 3.705996507732915*^9}, 3.705997102242079*^9, 
   3.705997173375952*^9, 3.7059972468672943`*^9, 3.705998293343171*^9, 
   3.7059992801418667`*^9, {3.705999837967284*^9, 3.70599986138758*^9}, 
   3.70600016234079*^9, 3.706000313034565*^9, 3.7060005764205236`*^9, 
   3.706000630094162*^9, 3.70600066463111*^9, 3.706000763095245*^9, 
   3.706000796810012*^9, {3.7060010690108852`*^9, 3.7060010812524223`*^9}, 
   3.706001166902426*^9, 3.706001354100169*^9, 3.706001432273562*^9, 
   3.706001520931995*^9, 3.7060025426509323`*^9, 3.70600440010713*^9, 
   3.706004480813656*^9, 3.706004597041257*^9, 3.706004773041234*^9, 
   3.706004951171904*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`time$$ = 1., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`time$$], 0, 1}}, Typeset`size$$ = {
    360., {182., 186.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`time$64122$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`time$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`time$$, $CellContext`time$64122$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        Graphics[{Black, 
          
          ReplaceAll[$CellContext`Graphicshand, $CellContext`t -> \
$CellContext`time$$], Black, 
          
          ReplaceAll[$CellContext`Graphicsballbefore, $CellContext`t -> \
$CellContext`time$$], Black, 
          
          ReplaceAll[$CellContext`Graphicsballlinebefore, $CellContext`t -> \
$CellContext`time$$]}, Axes -> True]], 
      "Specifications" :> {{$CellContext`time$$, 0, 1, AnimationRunning -> 
         False, AnimationRate -> 1., 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{405., {218., 224.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6965315300773563`*^9, 3.6965315962108088`*^9}, 
   3.696531646729567*^9, 3.696531680014011*^9, 3.6965317519547043`*^9, 
   3.696531793114656*^9, {3.6965318371315823`*^9, 3.696531888985725*^9}, 
   3.696532824219171*^9, {3.696533102069803*^9, 3.6965331386831827`*^9}, 
   3.696533192114831*^9, 3.696533338936191*^9, 3.6965336279822493`*^9, 
   3.69653404891638*^9, 3.696534203883967*^9, 3.696534309658966*^9, 
   3.696534843099267*^9, {3.6965355184255323`*^9, 3.696535538248932*^9}, 
   3.6965355903211203`*^9, {3.6965356416065607`*^9, 3.696535665090036*^9}, 
   3.696535903336513*^9, 3.696535976308874*^9, 3.696536010806052*^9, 
   3.696536065684609*^9, 3.696536110412003*^9, 3.696536433374323*^9, {
   3.696536469279688*^9, 3.6965364732413607`*^9}, 3.6965365680437727`*^9, 
   3.6965366906167316`*^9, 3.6965368296104717`*^9, 3.696536898207399*^9, 
   3.696537051077476*^9, 3.696537127091845*^9, {3.696537317937583*^9, 
   3.696537328592206*^9}, {3.6965374243721123`*^9, 3.696537498995224*^9}, {
   3.696537591052437*^9, 3.6965376042143*^9}, 3.696537634305717*^9, 
   3.696537681731533*^9, 3.6965377990495243`*^9, 3.696538843846229*^9, 
   3.6965389098814373`*^9, 3.696538940623773*^9, 3.6965397793927317`*^9, 
   3.6965398253283863`*^9, 3.696539897569458*^9, 3.696539961945545*^9, 
   3.696539998537758*^9, 3.69654002970784*^9, 3.696540110762104*^9, {
   3.696541432849471*^9, 3.6965414550020437`*^9}, 3.696541535161705*^9, 
   3.696541717696262*^9, 3.696541788755907*^9, {3.696542063205192*^9, 
   3.696542090482441*^9}, 3.696542181858322*^9, {3.696542315532235*^9, 
   3.696542332567954*^9}, 3.696542554346089*^9, 3.69654262701196*^9, {
   3.696542667656443*^9, 3.6965426891012793`*^9}, 3.696542772214324*^9, 
   3.6965428489409246`*^9, 3.696542898092678*^9, 3.696543814838974*^9, 
   3.69654385151278*^9, 3.6965439491092033`*^9, 3.696544045888966*^9, {
   3.696544099271523*^9, 3.6965441181807003`*^9}, 3.6965443935999823`*^9, {
   3.696544428282263*^9, 3.6965444424190807`*^9}, {3.6965444767501383`*^9, 
   3.6965444996901083`*^9}, 3.696544886436577*^9, 3.696544920541274*^9, 
   3.696544993803665*^9, 3.696545319896871*^9, 3.696545781302799*^9, 
   3.696546599207896*^9, 3.696547117993579*^9, 3.696547155071313*^9, 
   3.696547219916855*^9, {3.6965472941466427`*^9, 3.696547309082158*^9}, 
   3.6965473761665287`*^9, 3.696547455650981*^9, 3.6965475570625257`*^9, 
   3.69654796360539*^9, {3.696567973042037*^9, 3.696567988832099*^9}, 
   3.696568204082795*^9, 3.696569056487072*^9, 3.696569104032612*^9, 
   3.696569178907783*^9, 3.696569222418056*^9, 3.6965693619862223`*^9, 
   3.69656945440998*^9, 3.696569590239862*^9, 3.696569638587345*^9, 
   3.696569722344054*^9, 3.69656986237838*^9, 3.696569963928151*^9, 
   3.696570069922697*^9, 3.696570141731819*^9, 3.6965702915910997`*^9, 
   3.696570381456401*^9, 3.696570548623693*^9, 3.696570655196231*^9, 
   3.696570759288309*^9, 3.696570816474882*^9, {3.696570858394002*^9, 
   3.6965709162280293`*^9}, 3.696571054698348*^9, 3.6965711091887836`*^9, 
   3.6965712148496437`*^9, 3.69657125897127*^9, 3.696571330894562*^9, 
   3.6965715616965027`*^9, 3.696571693056823*^9, 3.69657182043788*^9, {
   3.696655208023489*^9, 3.696655226791985*^9}, 3.6966559924332848`*^9, 
   3.6966560438525877`*^9, 3.69665627802435*^9, 3.7059515157390623`*^9, 
   3.705951590923867*^9, 3.7059517168811417`*^9, 3.70595186194468*^9, 
   3.705955211199381*^9, 3.7059562718047028`*^9, 3.705958985393175*^9, 
   3.705968244575646*^9, 3.705969553331332*^9, 3.705969755847209*^9, 
   3.70597035327426*^9, 3.705970490289521*^9, 3.7059710000499268`*^9, 
   3.705971033706923*^9, 3.705971108822607*^9, 3.7059712717342863`*^9, 
   3.705971378666038*^9, 3.705971918148481*^9, 3.705972053268547*^9, {
   3.705972218344226*^9, 3.705972245012912*^9}, 3.705972294189543*^9, {
   3.705972682205261*^9, 3.7059727040212603`*^9}, 3.705972863328156*^9, 
   3.7059729059478188`*^9, 3.705973403433311*^9, {3.70597349818988*^9, 
   3.7059735162200603`*^9}, 3.705973594460994*^9, 3.705973674343207*^9, 
   3.70597378962846*^9, 3.705973891103304*^9, 3.705973935318056*^9, 
   3.705977044737133*^9, 3.705979702211178*^9, 3.7059798414271708`*^9, 
   3.705980173101869*^9, 3.70598095605276*^9, 3.7059837109511766`*^9, 
   3.705983854071081*^9, 3.705984013405445*^9, 3.705984294303527*^9, 
   3.705984512396351*^9, 3.7059848394030457`*^9, {3.705987916868803*^9, 
   3.705987920709064*^9}, 3.7059879533661613`*^9, 3.705988823297977*^9, 
   3.7059888718373337`*^9, 3.70599001603238*^9, 3.70599015786762*^9, 
   3.705990233269158*^9, 3.705990857198572*^9, 3.705991087239047*^9, 
   3.705991413090621*^9, 3.705991564919867*^9, 3.7059916223626204`*^9, 
   3.7059918184321203`*^9, 3.705991893610175*^9, 3.705992556698241*^9, 
   3.705992666195796*^9, 3.705992731272386*^9, 3.705992916488228*^9, 
   3.7059931271363287`*^9, 3.705993375507599*^9, 3.705993421496903*^9, {
   3.7059937149943666`*^9, 3.7059937391061993`*^9}, 3.705993878693918*^9, 
   3.705994003806273*^9, 3.70599409322523*^9, {3.70599413003857*^9, 
   3.705994159471155*^9}, 3.705994269328837*^9, 3.705994344220442*^9, 
   3.705994383829342*^9, 3.705994417643167*^9, 3.705994719316642*^9, 
   3.7059947839353848`*^9, 3.705994932017803*^9, 3.70599500600667*^9, 
   3.7059951313307123`*^9, 3.705995686329584*^9, 3.705996435584453*^9, {
   3.7059964785494432`*^9, 3.705996507732915*^9}, 3.705997102242079*^9, 
   3.705997173375952*^9, 3.7059972468672943`*^9, 3.705998293343171*^9, 
   3.7059992801418667`*^9, {3.705999837967284*^9, 3.70599986138758*^9}, 
   3.70600016234079*^9, 3.706000313034565*^9, 3.7060005764205236`*^9, 
   3.706000630094162*^9, 3.70600066463111*^9, 3.706000763095245*^9, 
   3.706000796810012*^9, {3.7060010690108852`*^9, 3.7060010812524223`*^9}, 
   3.706001166902426*^9, 3.706001354100169*^9, 3.706001432273562*^9, 
   3.706001520931995*^9, 3.7060025426509323`*^9, 3.70600440010713*^9, 
   3.706004480813656*^9, 3.706004597041257*^9, 3.706004773041234*^9, 
   3.706004951235434*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Stage 2 - Ball rolls on hand (constrained to maintain hand contact)\
\>", "Section",
 CellChangeTimes->{{3.690243903581335*^9, 3.6902439110441513`*^9}, {
   3.6902632976278353`*^9, 3.6902633098058577`*^9}, {3.696008588514721*^9, 
   3.696008611559229*^9}, 3.696354264426257*^9, {3.705971187172201*^9, 
   3.705971257568466*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "New", " ", "Ball", " ", "Frame", " ", "Transforms", " ", "for", " ", 
    "time", " ", "after", " ", "roll"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gball", "=", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], ",", 
        RowBox[{"y", "[", "t", "]"}], ",", "0"}], "]"}], ".", 
      RowBox[{"g", "[", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ghandball", "=", 
     RowBox[{
      RowBox[{"Inverse", "[", "ghand", "]"}], ".", "gball"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"ball", " ", "in", " ", "hand", " ", "frame"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]handball", "=", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], "-", 
      RowBox[{"\[Theta]wrist", "[", "t", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xhandball", "=", 
     RowBox[{"ghandball", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"gcontact", "=", 
     RowBox[{"gwrist", ".", 
      RowBox[{"g", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Lhand", "/", "2"}], "-", 
         RowBox[{"rball", "*", "\[Theta]handball"}]}], ",", "0", ",", "0"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Point", " ", "of", " ", "contact"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mhand", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"gfingertip", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], "-", 
        RowBox[{"gwrist", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"gfingertip", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], "-", 
        RowBox[{"gwrist", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eqhand", "=", 
     RowBox[{
      RowBox[{"contacty", "-", 
       RowBox[{"gfingertip", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "\[Equal]", 
      RowBox[{"mhand", "*", 
       RowBox[{"(", 
        RowBox[{"contactx", "-", 
         RowBox[{"gfingertip", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eqprojection", "=", 
     RowBox[{
      RowBox[{"contacty", "-", 
       RowBox[{"gball", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "mhand"}], "*", 
       RowBox[{"(", 
        RowBox[{"contactx", "-", 
         RowBox[{"gball", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"contacttemp", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Eqhand", "&&", "Eqprojection"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"contactx", ",", "contacty"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"contactx", "=", 
     RowBox[{"contacttemp", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"contacty", "=", 
     RowBox[{"contacttemp", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Ball", " ", "Configuration", " ", "Variables"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], ",", 
         RowBox[{"y", "[", "t", "]"}], ",", 
         RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}], "}"}], 
      "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dq", "=", 
     RowBox[{"D", "[", 
      RowBox[{"q", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ddq", "=", 
     RowBox[{"D", "[", 
      RowBox[{"dq", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Lagrangian", " ", "using", " ", "body", " ", "velocities", " ", 
     RowBox[{"(", 
      RowBox[{"see", " ", "lecture", " ", "23"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vball", "=", 
     RowBox[{"unhat", "[", 
      RowBox[{
       RowBox[{"Inverse", "[", "gball", "]"}], ".", 
       RowBox[{"D", "[", 
        RowBox[{"gball", ",", "t"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Iball", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m", ",", 
        RowBox[{"m", "*", 
         RowBox[{"rball", "^", "2"}]}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"J", "=", 
      RowBox[{"m", "*", 
       RowBox[{"rball", "^", "2"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"KE", "=", 
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Vball", ".", "Iball"}], ")"}], ".", 
       RowBox[{
        RowBox[{"{", "Vball", "}"}], "\[Transpose]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PE", "=", 
     RowBox[{"m", "*", "grav", "*", 
      RowBox[{"y", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lag", " ", "=", 
     RowBox[{"KE", "-", "PE"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Constraints", " ", "and", " ", "External", " ", "forces"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "Constraints", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Ball", " ", "remains", " ", "in", " ", "contact", " ", "with", " ", 
     "last", " ", "link"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]a", "=", 
     RowBox[{
      RowBox[{"ghandball", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}], "+", "rball"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Ball", " ", "rolls", " ", "without", " ", "slipping", " ", "where", " ",
       "x"}], "=", 
     RowBox[{"rball", "*", "\[Theta]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]b", "=", 
     RowBox[{"xhandball", "-", 
      RowBox[{"rball", "*", "\[Theta]handball"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Euler", "-", 
     RowBox[{"Lagrange", " ", "equations", " ", "VECTORS"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"BOTH", " ", "constraints"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Eq1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Lag", ",", 
           RowBox[{
            RowBox[{"x", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
       "-", 
       RowBox[{"D", "[", 
        RowBox[{"Lag", ",", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[Equal]", 
      RowBox[{
       RowBox[{"\[Lambda]a", "*", 
        RowBox[{"D", "[", 
         RowBox[{"\[Phi]a", ",", 
          RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"\[Lambda]b", "*", 
        RowBox[{"D", "[", 
         RowBox[{"\[Phi]b", ",", 
          RowBox[{"x", "[", "t", "]"}]}], "]"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eq2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Lag", ",", 
           RowBox[{
            RowBox[{"y", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
       "-", 
       RowBox[{"D", "[", 
        RowBox[{"Lag", ",", 
         RowBox[{"y", "[", "t", "]"}]}], "]"}]}], "\[Equal]", 
      RowBox[{
       RowBox[{"\[Lambda]a", "*", 
        RowBox[{"D", "[", 
         RowBox[{"\[Phi]a", ",", 
          RowBox[{"y", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"\[Lambda]b", "*", 
        RowBox[{"D", "[", 
         RowBox[{"\[Phi]b", ",", 
          RowBox[{"y", "[", "t", "]"}]}], "]"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eq3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Lag", ",", 
           RowBox[{
            RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
        "]"}], "-", 
       RowBox[{"D", "[", 
        RowBox[{"Lag", ",", 
         RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "\[Equal]", 
      RowBox[{
       RowBox[{"\[Lambda]a", "*", 
        RowBox[{"D", "[", 
         RowBox[{"\[Phi]a", ",", 
          RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"\[Lambda]b", "*", 
        RowBox[{"D", "[", 
         RowBox[{"\[Phi]b", ",", 
          RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eq4", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"\[Phi]a", ",", "t"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
      "0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eq5", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"\[Phi]b", ",", "t"}], "]"}], ",", "t"}], "]"}], "\[Equal]", 
      "0"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "ODEs", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ELtemp", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Eq1", "&&", "Eq2", "&&", "Eq3", "&&", "Eq4", "&&", "Eq5"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "''"}], "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"y", "''"}], "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"\[Theta]", "''"}], "[", "t", "]"}], ",", "\[Lambda]a", ",",
          "\[Lambda]b"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EL", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "''"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{"ELtemp", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "''"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{"ELtemp", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "''"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{"ELtemp", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Constants", " ", "and", " ", "Initial", " ", "Condition"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"grav", " ", "=", " ", "9.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitCon", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", "troll", "]"}], "\[Equal]", "xr"}], ",", 
       RowBox[{
        RowBox[{"y", "[", "troll", "]"}], "\[Equal]", "yr"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "troll", "]"}], "\[Equal]", "\[Theta]r"}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "'"}], "[", "troll", "]"}], "\[Equal]", "xrdot"}], ",", 
       
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "troll", "]"}], "\[Equal]", "yrdot"}], ",", 
       
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "troll", "]"}], "\[Equal]", 
        "\[Theta]rdot"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Numerical", " ", "Solutions", " ", "for", " ", "Desired", " ", 
     "Trajectories"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"sol", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"EL", ",", "InitCon"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "\[Theta]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "troll", ",", "tMax"}], "}"}]}], "]"}]}], ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"sol", "=", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"EL", ",", "InitCon"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "\[Theta]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "troll", ",", "tMax"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<ExplicitRungeKutta\>\"", ",", 
           RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "4"}]}], "}"}]}]}], 
       "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"\[Theta]handball", "/.", 
     RowBox[{"t", "\[Rule]", "0"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Jwrist", "=", 
     RowBox[{"\[Theta]wristsol", "/.", 
      RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tRelease", "=", "tMax"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"EL", ",", "InitCon", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"determine", " ", "time", " ", "of", " ", "release"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rball", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Theta]", "[", "t", "]"}], "-", "Jwrist"}], "/.", 
                RowBox[{"time", "\[Rule]", "t"}]}], ")"}]}], ">", 
             RowBox[{"Lhand", "/", "2"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Let it fly!\>\"", "]"}], ",", 
              RowBox[{"tRelease", "=", "t"}], ",", 
              RowBox[{"Print", "[", "tRelease", "]"}], ",", 
              "\"\<StopIntegration\>\""}], "}"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"\"\<DetectionMethod\>\"", "\[Rule]", "\"\<Sign\>\""}]}], 
           "]"}], "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "\[Theta]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "troll", ",", "tMax"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<ExplicitRungeKutta\>\"", ",", 
          RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "3"}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xsol", "=", 
     RowBox[{
      RowBox[{"x", "[", "t", "]"}], "/.", "sol"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ysol", "=", 
     RowBox[{
      RowBox[{"y", "[", "t", "]"}], "/.", "sol"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]sol", "=", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], "/.", "sol"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"PLOTS", " ", "AND", " ", "ANIMATION"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"\[Phi]a", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "troll", ",", "tRelease"}], "}"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<\[Phi]a constraint\>\""}]}], 
      "]"}], "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"\[Phi]b", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "troll", ",", "tRelease"}], "}"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<\[Phi]b constraint\>\""}]}], 
      "]"}], "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "xhandball", ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "troll", ",", "tRelease"}], "}"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<xhandball\>\""}]}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"\[Theta]handball", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "troll", ",", "tRelease"}], "}"}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", "\"\<ball angle relative to hand\>\""}]}], 
      "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "troll", ",", "tRelease"}], "}"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<x[t]\>\""}]}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "[", "t", "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "troll", ",", "tRelease"}], "}"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<y[t]\>\""}]}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "[", "t", "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "troll", ",", "tRelease"}], "}"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<\[Theta][t]\>\""}]}], "]"}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Dynamic", " ", "coords", " ", "and", " ", "graphics"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coordball", "[", "time_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gball", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"gball", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ")"}], "/.", 
      RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coordcontact", "[", "time_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"contactx", ",", "contacty"}], "}"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ")"}], "/.", 
      RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gmidline1", "=", 
     RowBox[{"gball", ".", 
      RowBox[{"g", "[", 
       RowBox[{
        RowBox[{"-", "rball"}], ",", "0", ",", "0"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gmidline2", "=", 
     RowBox[{"gball", ".", 
      RowBox[{"g", "[", 
       RowBox[{"rball", ",", "0", ",", "0"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coordmidline1", "[", "time_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gmidline1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"gmidline1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ")"}], "/.", 
      RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coordmidline2", "[", "time_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gmidline2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"gmidline2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
           "\[Theta]wristsol"}], ",", 
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
         "}"}]}], ")"}], "/.", 
      RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphicsball", " ", "=", " ", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"coordball", "[", "t", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"coordball", "[", "t", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "rball"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphicscontact", "=", 
     RowBox[{"Locator", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"coordcontact", "[", "t", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"coordcontact", "[", "t", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphicsballline", "=", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coordmidline1", "[", "t", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"coordmidline1", "[", "t", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coordmidline2", "[", "t", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"coordmidline2", "[", "t", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Animate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"Black", ",", 
          RowBox[{"Graphicshand", "/.", 
           RowBox[{"t", "\[Rule]", "time"}]}], ",", "\[IndentingNewLine]", 
          "Black", ",", 
          RowBox[{"Graphicsball", "/.", 
           RowBox[{"t", "\[Rule]", "time"}]}], ",", "\[IndentingNewLine]", 
          "Black", ",", 
          RowBox[{"Graphicsballline", "/.", 
           RowBox[{"t", "\[Rule]", "time"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Graphicscontact", "/.", 
           RowBox[{"t", "\[Rule]", "time"}]}]}], "\[IndentingNewLine]", "}"}],
         "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "8"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "8"}], "}"}]}], "}"}]}], ","}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"Axes", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"time", ",", "troll", ",", "tRelease"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AnimationRate", "\[Rule]", "1.0"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6902439230546627`*^9, 3.69024399666831*^9}, {
   3.69024629332731*^9, 3.6902463691265793`*^9}, {3.690246506826724*^9, 
   3.690246578472685*^9}, {3.690246707929229*^9, 3.69024677887889*^9}, {
   3.6902468776041393`*^9, 3.690246900799637*^9}, {3.690248091879241*^9, 
   3.690248093938933*^9}, {3.690248171802619*^9, 3.6902481817175493`*^9}, 
   3.690248305699211*^9, 3.690248576293268*^9, {3.690248658345484*^9, 
   3.690248661747633*^9}, {3.690248735172584*^9, 3.6902488445349197`*^9}, {
   3.690249609138234*^9, 3.690249646146061*^9}, {3.690249680431816*^9, 
   3.690249702636834*^9}, {3.6902497338150063`*^9, 3.6902497428889647`*^9}, 
   3.690249778555636*^9, {3.6902498150602493`*^9, 3.690250012562022*^9}, {
   3.690250050783156*^9, 3.690250153072483*^9}, {3.690250189012376*^9, 
   3.69025019348593*^9}, {3.690250944227412*^9, 3.69025096387887*^9}, 
   3.6902510451713963`*^9, {3.6902510793827477`*^9, 3.6902511063587217`*^9}, 
   3.69025159685779*^9, {3.690251644257812*^9, 3.6902516445848017`*^9}, {
   3.690251826672019*^9, 3.690251832391259*^9}, 3.6902520073811407`*^9, 
   3.690252045329636*^9, {3.690252310147346*^9, 3.6902523286276608`*^9}, {
   3.690252377242731*^9, 3.6902524212876596`*^9}, {3.690252457328637*^9, 
   3.690252481898128*^9}, {3.690252524835091*^9, 3.690252549060069*^9}, {
   3.690252589921115*^9, 3.690252590597411*^9}, {3.690252678012694*^9, 
   3.690252682507873*^9}, 3.69025271477433*^9, {3.690252796428071*^9, 
   3.690252819561804*^9}, {3.690252910492906*^9, 3.690252934500573*^9}, {
   3.690253025320066*^9, 3.69025304751127*^9}, {3.690253089682469*^9, 
   3.690253115216762*^9}, 3.6902543258371553`*^9, {3.690254368330229*^9, 
   3.690254369764813*^9}, {3.6902544165842667`*^9, 3.690254546784281*^9}, {
   3.69025457848771*^9, 3.690254695915098*^9}, {3.690254762042582*^9, 
   3.690254781573243*^9}, {3.69025481862586*^9, 3.690254831696666*^9}, {
   3.6902548761018953`*^9, 3.690254887610589*^9}, {3.690254919242099*^9, 
   3.69025496710612*^9}, {3.690255001862424*^9, 3.690255036238385*^9}, 
   3.69025522617535*^9, {3.690255271552513*^9, 3.690255279742222*^9}, {
   3.69025533804664*^9, 3.6902553386885443`*^9}, {3.690255373691869*^9, 
   3.690255403899452*^9}, {3.690255449800395*^9, 3.690255582279188*^9}, {
   3.690255630729567*^9, 3.690255762163516*^9}, 3.690256041658951*^9, {
   3.690256193910317*^9, 3.690256230241798*^9}, {3.6902563567558737`*^9, 
   3.6902563636993513`*^9}, {3.690256438981832*^9, 3.690256455509527*^9}, {
   3.6902565146664143`*^9, 3.690256515817913*^9}, {3.690256608325873*^9, 
   3.690256610379879*^9}, {3.690256655229397*^9, 3.6902566570428057`*^9}, {
   3.690256751776566*^9, 3.6902567595735073`*^9}, {3.690256998410458*^9, 
   3.69025701620107*^9}, {3.690257070117077*^9, 3.69025708050742*^9}, {
   3.6902572314653597`*^9, 3.6902572338277483`*^9}, {3.6902573006344976`*^9, 
   3.690257301077607*^9}, {3.690257375742469*^9, 3.690257400809164*^9}, {
   3.690257563575938*^9, 3.690257583417869*^9}, {3.690257683248453*^9, 
   3.690257711505972*^9}, {3.690257761722712*^9, 3.6902577633242702`*^9}, {
   3.690257815894703*^9, 3.690257849437418*^9}, {3.690257897450161*^9, 
   3.690257946527237*^9}, {3.6902580410297832`*^9, 3.690258267005508*^9}, {
   3.6902583033224783`*^9, 3.690258342845289*^9}, {3.690258435137281*^9, 
   3.690258435623898*^9}, 3.690258475478612*^9, {3.6902585533799143`*^9, 
   3.690258556042882*^9}, {3.6902586503220873`*^9, 3.69025865462919*^9}, {
   3.690258859760737*^9, 3.690258867449259*^9}, {3.690258916979259*^9, 
   3.690258973067103*^9}, {3.690259012520331*^9, 3.690259077695566*^9}, {
   3.69025936029714*^9, 3.69025939872616*^9}, {3.690259530644805*^9, 
   3.690259531028886*^9}, {3.690259694678514*^9, 3.690259768773555*^9}, {
   3.690259834820181*^9, 3.690259836016069*^9}, {3.690260940874185*^9, 
   3.690261039351012*^9}, {3.690261111089306*^9, 3.690261131954865*^9}, {
   3.690261443453966*^9, 3.690261536079378*^9}, {3.690261585843151*^9, 
   3.690261612116366*^9}, {3.690261806701007*^9, 3.6902618271247177`*^9}, {
   3.69026207507234*^9, 3.690262079520298*^9}, 3.690262592309654*^9, {
   3.690273573195175*^9, 3.690273574338765*^9}, {3.6902744942106457`*^9, 
   3.690274501585732*^9}, {3.6902747412606573`*^9, 3.690274852579351*^9}, 
   3.690275451409154*^9, {3.690277645541194*^9, 3.690277658043919*^9}, {
   3.690277737921158*^9, 3.690277738211218*^9}, 3.6902777706854897`*^9, 
   3.695997636375778*^9, 3.695997671139331*^9, {3.6959977987417583`*^9, 
   3.695997827707259*^9}, {3.696005361205017*^9, 3.696005421305482*^9}, {
   3.696005580587367*^9, 3.696005581313408*^9}, {3.696005823497184*^9, 
   3.6960058400638533`*^9}, 3.696006330469254*^9, {3.696007452405458*^9, 
   3.696007473622737*^9}, {3.69600867887611*^9, 3.696008689066173*^9}, {
   3.6960087252640533`*^9, 3.696008741021145*^9}, {3.6960088145951242`*^9, 
   3.696008814782817*^9}, {3.696009059496889*^9, 3.69600907239529*^9}, {
   3.69600913082908*^9, 3.696009163008543*^9}, {3.696009207456293*^9, 
   3.696009234370799*^9}, {3.696009268355994*^9, 3.696009268706883*^9}, {
   3.69600939661624*^9, 3.6960094379542313`*^9}, {3.696009481997251*^9, 
   3.6960095047690687`*^9}, {3.696009540264514*^9, 3.696009543647547*^9}, {
   3.6960095929236517`*^9, 3.69600963996603*^9}, {3.696009675339292*^9, 
   3.6960096932324057`*^9}, {3.6960097398555603`*^9, 3.696009750409563*^9}, {
   3.696009817330737*^9, 3.696009829978717*^9}, {3.696009868020359*^9, 
   3.6960099051883373`*^9}, {3.696009949575508*^9, 3.6960099758589287`*^9}, {
   3.69601010660854*^9, 3.6960101180840387`*^9}, {3.696010665637487*^9, 
   3.696010677090785*^9}, {3.696010747274292*^9, 3.6960107656681213`*^9}, {
   3.696010850478053*^9, 3.696010850584955*^9}, {3.696010906708939*^9, 
   3.696010929063295*^9}, {3.696011401027094*^9, 3.6960114033252983`*^9}, {
   3.696014870169475*^9, 3.6960148721082497`*^9}, {3.6960150874771957`*^9, 
   3.696015110235976*^9}, 3.696015253297571*^9, {3.696015515611795*^9, 
   3.696015539662383*^9}, 3.696015879171793*^9, {3.6960161288926363`*^9, 
   3.69601613270795*^9}, {3.696016221124886*^9, 3.696016222361018*^9}, {
   3.696016268503237*^9, 3.696016307701304*^9}, 3.696016356534355*^9, {
   3.6960163872916527`*^9, 3.696016472708955*^9}, {3.696016504986822*^9, 
   3.696016510035872*^9}, {3.696016742893463*^9, 3.696016825183284*^9}, {
   3.696017162863936*^9, 3.696017168729925*^9}, {3.69601837049907*^9, 
   3.696018379952393*^9}, {3.6960185552816277`*^9, 3.696018558539831*^9}, {
   3.696018597262599*^9, 3.6960186003652782`*^9}, {3.69601873993075*^9, 
   3.69601874616784*^9}, {3.69601888691895*^9, 3.696018891907679*^9}, {
   3.696018955707281*^9, 3.69601903274044*^9}, {3.696019071593546*^9, 
   3.696019119398395*^9}, {3.6960191543223867`*^9, 3.69601926862764*^9}, {
   3.696019302948451*^9, 3.696019307245782*^9}, {3.696019368245393*^9, 
   3.696019372218079*^9}, {3.696019427090578*^9, 3.696019427830934*^9}, {
   3.696021404823011*^9, 3.696021435000404*^9}, 3.696022177628146*^9, {
   3.696022328533881*^9, 3.69602242862647*^9}, {3.696022474055934*^9, 
   3.696022481936943*^9}, {3.696022516503459*^9, 3.696022634546321*^9}, 
   3.696022723595433*^9, {3.69602322916374*^9, 3.696023243433415*^9}, {
   3.6960235261705427`*^9, 3.696023532897358*^9}, {3.69602384464135*^9, 
   3.696023953409628*^9}, {3.6960240842529907`*^9, 3.6960240904154243`*^9}, {
   3.696024131081218*^9, 3.696024150037685*^9}, {3.696024315785213*^9, 
   3.696024341315905*^9}, {3.696024768488379*^9, 3.696024769953143*^9}, {
   3.6960248450617647`*^9, 3.696024880110018*^9}, {3.696024913629072*^9, 
   3.6960249292502203`*^9}, {3.6960256396563168`*^9, 
   3.6960256536744537`*^9}, {3.696025879712381*^9, 3.6960258931279793`*^9}, {
   3.696026045922203*^9, 3.696026049883334*^9}, {3.696026098739909*^9, 
   3.696026104484501*^9}, {3.696026493874627*^9, 3.6960264997861633`*^9}, {
   3.696026530146592*^9, 3.696026564990493*^9}, {3.6960266004906054`*^9, 
   3.6960266014360733`*^9}, {3.696026953061438*^9, 3.696026957676915*^9}, {
   3.696027496795672*^9, 3.696027502366303*^9}, {3.696027988823992*^9, 
   3.696027996261702*^9}, {3.696028187936281*^9, 3.6960281996825457`*^9}, {
   3.6960282545930243`*^9, 3.696028254746964*^9}, {3.696028341723954*^9, 
   3.6960284519461727`*^9}, 3.696028596142172*^9, {3.6960287860393543`*^9, 
   3.69602879316341*^9}, {3.69602884105208*^9, 3.6960288441907043`*^9}, {
   3.696028930818161*^9, 3.696028936397113*^9}, {3.696029029924374*^9, 
   3.696029065379533*^9}, {3.6960291049541483`*^9, 3.696029106877531*^9}, {
   3.696029679978115*^9, 3.696029741267034*^9}, {3.696354267250135*^9, 
   3.6963542755401707`*^9}, 3.6963638857009163`*^9, {3.696365156989726*^9, 
   3.696365171856861*^9}, {3.696365232697074*^9, 3.696365311580964*^9}, {
   3.696365344779464*^9, 3.6963653460486813`*^9}, {3.696365441343672*^9, 
   3.696365445210071*^9}, {3.696365484490893*^9, 3.6963655113091087`*^9}, {
   3.696365571363812*^9, 3.696365598403143*^9}, {3.696366072093293*^9, 
   3.696366141953926*^9}, {3.6963661913571*^9, 3.696366266698361*^9}, {
   3.696366423185223*^9, 3.696366426091798*^9}, {3.69636648781984*^9, 
   3.6963665728116503`*^9}, {3.696366985505917*^9, 3.696367004559692*^9}, {
   3.6963671728720627`*^9, 3.6963671739463243`*^9}, {3.6963672051632357`*^9, 
   3.6963672061913137`*^9}, {3.696368195137992*^9, 3.6963682202031527`*^9}, {
   3.696368713932661*^9, 3.696368769654747*^9}, {3.6963718304202757`*^9, 
   3.696371830938195*^9}, {3.696371892836925*^9, 3.696371893669076*^9}, {
   3.696372062080052*^9, 3.6963720626095057`*^9}, 3.696435747312047*^9, {
   3.696435888990625*^9, 3.696435928246997*^9}, {3.6964367538021317`*^9, 
   3.6964367679008617`*^9}, {3.696437028390359*^9, 3.6964370653156548`*^9}, {
   3.696437281353423*^9, 3.696437283383122*^9}, {3.696437319005134*^9, 
   3.696437423224188*^9}, {3.696437466800193*^9, 3.696437548382009*^9}, {
   3.696437581079236*^9, 3.696437605327155*^9}, {3.696437779895124*^9, 
   3.69643780452026*^9}, {3.6964378761782227`*^9, 3.696437876279716*^9}, {
   3.696438635777988*^9, 3.696438804516843*^9}, {3.696438880609811*^9, 
   3.696438970165785*^9}, {3.696439335608842*^9, 3.696439338030816*^9}, {
   3.696439373011649*^9, 3.696439374631427*^9}, {3.696439453246011*^9, 
   3.696439506981204*^9}, {3.6964395718097677`*^9, 3.69643959518054*^9}, {
   3.696439634474799*^9, 3.696439637406578*^9}, {3.696439852261263*^9, 
   3.6964398598818808`*^9}, {3.696440711835772*^9, 3.696440712018737*^9}, {
   3.696440743592411*^9, 3.696440743894754*^9}, 3.696440777076502*^9, 
   3.6964408109412518`*^9, 3.696440970317483*^9, {3.696441115700663*^9, 
   3.69644112834691*^9}, {3.6964412392157097`*^9, 3.696441245636002*^9}, {
   3.696441448215869*^9, 3.696441470301589*^9}, {3.6964419311808367`*^9, 
   3.696441932941402*^9}, {3.6964622155560837`*^9, 3.696462215725457*^9}, {
   3.6964622664645348`*^9, 3.696462306919537*^9}, {3.696462374867673*^9, 
   3.696462385294512*^9}, {3.696462535948001*^9, 3.696462574013509*^9}, {
   3.696462677627863*^9, 3.696462679461068*^9}, {3.696462897664747*^9, 
   3.696462898866292*^9}, {3.6964630119810534`*^9, 3.6964630487171926`*^9}, {
   3.696463148637556*^9, 3.696463150815661*^9}, {3.696463233651774*^9, 
   3.696463239619258*^9}, {3.6964636755963373`*^9, 3.6964637084274197`*^9}, {
   3.6964637402311373`*^9, 3.6964637520146227`*^9}, {3.696463985175375*^9, 
   3.696464002540428*^9}, {3.696464059958336*^9, 3.69646406534916*^9}, {
   3.69646429817962*^9, 3.696464319788062*^9}, {3.696464425263369*^9, 
   3.696464439108358*^9}, {3.6964644929879293`*^9, 3.6964645636736107`*^9}, {
   3.6964665451125402`*^9, 3.696466575392976*^9}, {3.6964666117557163`*^9, 
   3.696466628513329*^9}, {3.696466667104329*^9, 3.69646669652538*^9}, {
   3.696466739189934*^9, 3.696466831600333*^9}, {3.696466873543985*^9, 
   3.696466920215082*^9}, {3.696466970994961*^9, 3.696466972138912*^9}, {
   3.696467004642939*^9, 3.6964670082390842`*^9}, {3.696467047992894*^9, 
   3.696467048151342*^9}, {3.696467355876584*^9, 3.696467390992482*^9}, {
   3.69646742567724*^9, 3.6964674322230177`*^9}, {3.6964675239083*^9, 
   3.696467562129923*^9}, {3.696467636957559*^9, 3.69646766302496*^9}, {
   3.696467836681135*^9, 3.696467862737118*^9}, 3.696468240780848*^9, {
   3.696468518423284*^9, 3.696468527193923*^9}, {3.69646859961377*^9, 
   3.6964686044993*^9}, {3.696468863787521*^9, 3.696468867836069*^9}, {
   3.696468980649106*^9, 3.696468985167532*^9}, {3.696469105198825*^9, 
   3.69646915354917*^9}, {3.6964692041180964`*^9, 3.6964692395876923`*^9}, {
   3.696469299479941*^9, 3.696469332703599*^9}, {3.696469446119028*^9, 
   3.696469446908375*^9}, {3.696469517123238*^9, 3.696469528583456*^9}, {
   3.696469568280026*^9, 3.696469610544586*^9}, {3.6964696498905487`*^9, 
   3.696469671682724*^9}, {3.696469770600151*^9, 3.696469770782896*^9}, {
   3.6964698596703777`*^9, 3.696469861784885*^9}, {3.6964699034975853`*^9, 
   3.696469903698082*^9}, {3.696469945520918*^9, 3.696469980963798*^9}, {
   3.696470039792006*^9, 3.696470081442189*^9}, {3.6964701247286577`*^9, 
   3.696470189545109*^9}, {3.6964702524984903`*^9, 3.6964702769464684`*^9}, {
   3.696471703121656*^9, 3.6964717520268803`*^9}, {3.696471798839563*^9, 
   3.696471802925252*^9}, {3.69647185912708*^9, 3.696472025671607*^9}, 
   3.6964728902361813`*^9, {3.696473009750627*^9, 3.696473109810081*^9}, {
   3.6964731487642927`*^9, 3.696473195286147*^9}, {3.6964732859051723`*^9, 
   3.6964733356852283`*^9}, {3.696473441134454*^9, 3.696473455172056*^9}, {
   3.69647350576175*^9, 3.6964735260460453`*^9}, {3.696473614761887*^9, 
   3.696473615249156*^9}, {3.696474226973579*^9, 3.696474228454659*^9}, {
   3.696474260466263*^9, 3.696474284871242*^9}, {3.696474516908474*^9, 
   3.696474554942234*^9}, 3.696474617127594*^9, {3.696474723310746*^9, 
   3.696474800017736*^9}, {3.696474925171583*^9, 3.6964750572045794`*^9}, {
   3.6964750961053457`*^9, 3.69647515266719*^9}, {3.696475282051346*^9, 
   3.6964753189191837`*^9}, {3.696475370731987*^9, 3.696475374341367*^9}, {
   3.696475412354726*^9, 3.696475491343684*^9}, {3.696475530847472*^9, 
   3.696475636185574*^9}, {3.6964757280684423`*^9, 3.696475757603779*^9}, {
   3.696475814435046*^9, 3.6964758175189123`*^9}, {3.696475869929082*^9, 
   3.696475892009283*^9}, {3.6964759287677917`*^9, 3.696475930858713*^9}, {
   3.696475998046282*^9, 3.6964760106549673`*^9}, {3.696476042682886*^9, 
   3.696476083256349*^9}, {3.6964761226457157`*^9, 3.696476190923788*^9}, 
   3.696476227115633*^9, {3.6964762701961718`*^9, 3.696476281200778*^9}, {
   3.696476314898561*^9, 3.696476350946533*^9}, {3.696476439235827*^9, 
   3.6964764479763536`*^9}, {3.696476503099339*^9, 3.69647662397757*^9}, {
   3.696476730807213*^9, 3.69647679299387*^9}, {3.6964768507708178`*^9, 
   3.696476894088814*^9}, {3.696476952420573*^9, 3.696476961993536*^9}, {
   3.696477038006174*^9, 3.6964770604658737`*^9}, {3.6964771347651443`*^9, 
   3.696477142143653*^9}, {3.696477268333634*^9, 3.696477280425085*^9}, 
   3.696477438890039*^9, 3.696477491834813*^9, {3.696477529631796*^9, 
   3.696477531641684*^9}, {3.6964776079999323`*^9, 3.696477611795023*^9}, {
   3.6964776425693808`*^9, 3.6964776435152473`*^9}, {3.6964777169196367`*^9, 
   3.6964777243207827`*^9}, {3.696477947165977*^9, 3.696477967269039*^9}, {
   3.696478616540501*^9, 3.696478672875812*^9}, 3.696478737349441*^9, {
   3.696478894003187*^9, 3.696478941696492*^9}, {3.696479114132832*^9, 
   3.6964791573389273`*^9}, {3.696479199998433*^9, 3.696479205286755*^9}, 
   3.696479289357686*^9, {3.696482922372489*^9, 3.696482976637189*^9}, {
   3.6964830195113173`*^9, 3.6964830327782516`*^9}, {3.696526246032483*^9, 
   3.696526252034202*^9}, {3.696526308408001*^9, 3.69652641510219*^9}, {
   3.696526460035803*^9, 3.696526460103384*^9}, {3.696526587384961*^9, 
   3.69652659012351*^9}, {3.696526623285431*^9, 3.696526662649754*^9}, {
   3.6965267044361677`*^9, 3.6965267646428823`*^9}, {3.696526839436603*^9, 
   3.696526859660103*^9}, 3.696526970716741*^9, {3.696527073488015*^9, 
   3.6965270896626*^9}, {3.696527154720313*^9, 3.696527160178625*^9}, {
   3.696527213207459*^9, 3.696527244280591*^9}, {3.696527301344562*^9, 
   3.696527316445591*^9}, {3.6965277035983553`*^9, 3.696527734645197*^9}, {
   3.696527899469409*^9, 3.696528071170258*^9}, {3.696528112010854*^9, 
   3.696528123684074*^9}, {3.6965282709425983`*^9, 3.6965283051075363`*^9}, {
   3.6965284010576267`*^9, 3.696528466810336*^9}, {3.696528547984017*^9, 
   3.696528640220882*^9}, {3.696528697944477*^9, 3.6965287084136667`*^9}, {
   3.69652879099548*^9, 3.6965288595547323`*^9}, {3.696528889937068*^9, 
   3.696528979165663*^9}, {3.6965290670121326`*^9, 3.696529069756233*^9}, {
   3.696529104366856*^9, 3.69652913603162*^9}, {3.6965291793271227`*^9, 
   3.696529218134204*^9}, {3.6965292676504602`*^9, 3.696529296611492*^9}, {
   3.6965294291075077`*^9, 3.6965294364408417`*^9}, {3.696529480492936*^9, 
   3.696529481846856*^9}, {3.69652952578351*^9, 3.696529534525866*^9}, {
   3.69652966705464*^9, 3.69652970160823*^9}, {3.696529777657659*^9, 
   3.696529809688979*^9}, {3.696529855725972*^9, 3.696529873568946*^9}, {
   3.696529911021101*^9, 3.696529949524104*^9}, {3.696529982292849*^9, 
   3.696529989774415*^9}, {3.6965300465774527`*^9, 3.6965300740132837`*^9}, {
   3.696530136302864*^9, 3.696530166802445*^9}, {3.696530199841604*^9, 
   3.696530327804182*^9}, {3.696530406117515*^9, 3.696530497320373*^9}, {
   3.696530528601457*^9, 3.6965305313299513`*^9}, 3.696530614636298*^9, {
   3.696530691373567*^9, 3.6965306935781603`*^9}, {3.696530749798736*^9, 
   3.696530750894813*^9}, {3.696531196338428*^9, 3.696531223213848*^9}, {
   3.696531342072711*^9, 3.696531342108885*^9}, {3.696531469492386*^9, 
   3.6965314698297462`*^9}, {3.696532890575554*^9, 3.696532907440131*^9}, {
   3.696532981828673*^9, 3.696533000572723*^9}, {3.6965330806191263`*^9, 
   3.6965330819286633`*^9}, {3.696533250799752*^9, 3.696533257843258*^9}, {
   3.696533327752823*^9, 3.696533347527165*^9}, {3.696533420104763*^9, 
   3.696533554834352*^9}, {3.696533617048444*^9, 3.696533625426732*^9}, 
   3.696533655524732*^9, {3.696533696753952*^9, 3.696533749533554*^9}, {
   3.696533800554525*^9, 3.6965338325525103`*^9}, {3.69653386690094*^9, 
   3.696533994866748*^9}, {3.696534079241371*^9, 3.6965341877011833`*^9}, {
   3.696534258276945*^9, 3.6965343062089853`*^9}, {3.696534664942031*^9, 
   3.6965346854060783`*^9}, {3.6965348566939507`*^9, 3.696534923814777*^9}, 
   3.6965349637634773`*^9, {3.6965350150171423`*^9, 3.696535016552115*^9}, {
   3.6965351007435703`*^9, 3.6965352672375193`*^9}, {3.696535354335476*^9, 
   3.6965357511943073`*^9}, {3.696535782616332*^9, 3.696535840276573*^9}, {
   3.6965358900901833`*^9, 3.696535973990279*^9}, {3.696536007146964*^9, 
   3.696536107596381*^9}, {3.696536408061572*^9, 3.696536411984826*^9}, 
   3.6965364584830313`*^9, {3.6965365158895206`*^9, 3.696536562585291*^9}, {
   3.696536651630422*^9, 3.696536681205369*^9}, 3.69653677252905*^9, {
   3.696536818939455*^9, 3.696536826650343*^9}, {3.696537004296063*^9, 
   3.696537044134975*^9}, {3.696537139473474*^9, 3.696537139624198*^9}, 
   3.696537494157933*^9, {3.69653766627383*^9, 3.696537677743932*^9}, {
   3.696537786305385*^9, 3.69653779097659*^9}, {3.696537841195655*^9, 
   3.6965378725649757`*^9}, {3.696538873687605*^9, 3.6965388984044857`*^9}, {
   3.696538932101779*^9, 3.696538936467535*^9}, {3.696539221584277*^9, 
   3.696539243294175*^9}, {3.696539755805689*^9, 3.696539762178138*^9}, {
   3.696539792302902*^9, 3.696539819415386*^9}, {3.69653988589751*^9, 
   3.696539889115962*^9}, {3.696539991704805*^9, 3.696540026238717*^9}, {
   3.6965403841009617`*^9, 3.696540401559266*^9}, {3.696540465540347*^9, 
   3.696540469600881*^9}, {3.696540521316482*^9, 3.696540798735319*^9}, {
   3.6965411512908297`*^9, 3.696541218072803*^9}, {3.696541275786543*^9, 
   3.6965413124004374`*^9}, {3.696541476348693*^9, 3.696541577706993*^9}, {
   3.696541683393485*^9, 3.6965417130052433`*^9}, {3.696541749433563*^9, 
   3.6965417830403013`*^9}, {3.696542022122163*^9, 3.696542087319743*^9}, {
   3.696542163694667*^9, 3.696542166188477*^9}, {3.69654225986618*^9, 
   3.696542299283483*^9}, {3.696542340042314*^9, 3.6965423557772713`*^9}, {
   3.696542617634177*^9, 3.69654262255317*^9}, {3.696542660087709*^9, 
   3.6965426867850227`*^9}, {3.6965427505046663`*^9, 3.696542791608913*^9}, {
   3.696542836980076*^9, 3.696542840225397*^9}, {3.696543756243313*^9, 
   3.696543767334064*^9}, {3.6965438425723457`*^9, 3.6965438463790407`*^9}, 
   3.696543945921117*^9, {3.696544040652425*^9, 3.696544042813134*^9}, {
   3.6965440940967703`*^9, 3.6965441148729467`*^9}, {3.6965442081116343`*^9, 
   3.6965442296541643`*^9}, {3.6965443990053253`*^9, 3.696544496270413*^9}, {
   3.696544677390151*^9, 3.696544680265847*^9}, {3.696544882715971*^9, 
   3.6965449179209414`*^9}, 3.696544990908654*^9, 3.6965451746153717`*^9, {
   3.696545296265514*^9, 3.6965453315589657`*^9}, 3.696546594291973*^9, {
   3.696546979314188*^9, 3.6965469868791924`*^9}, {3.696547100510681*^9, 
   3.6965471158002777`*^9}, {3.696547149415802*^9, 3.6965471517324677`*^9}, {
   3.6965472835571737`*^9, 3.696547287673654*^9}, {3.696547373690879*^9, 
   3.696547373827422*^9}, {3.69656808408821*^9, 3.696568127408298*^9}, {
   3.696568201202248*^9, 3.696568201339745*^9}, {3.696568552988352*^9, 
   3.696568642660898*^9}, {3.6965686812083597`*^9, 3.696568779560178*^9}, {
   3.696568819866229*^9, 3.6965688881071377`*^9}, {3.696568938189406*^9, 
   3.696568989133994*^9}, {3.69656903832187*^9, 3.696569051108499*^9}, {
   3.696569089072631*^9, 3.696569095224699*^9}, {3.696569159909203*^9, 
   3.696569218606923*^9}, {3.696569297731003*^9, 3.696569307602829*^9}, {
   3.696569350760961*^9, 3.696569358035211*^9}, {3.696569579210318*^9, 
   3.696569584357029*^9}, {3.696569633889477*^9, 3.696569655788621*^9}, {
   3.696569710078393*^9, 3.69656971622434*^9}, {3.6965698304015713`*^9, 
   3.696569857769438*^9}, {3.696569953406374*^9, 3.696569960334263*^9}, {
   3.69657006531644*^9, 3.696570067108976*^9}, {3.6965701368842363`*^9, 
   3.696570148830504*^9}, {3.696570276025167*^9, 3.696570303543642*^9}, 
   3.6965703765826473`*^9, {3.696570530700594*^9, 3.69657054370756*^9}, {
   3.69657058570997*^9, 3.696570649582025*^9}, {3.6965707508276443`*^9, 
   3.696570754620989*^9}, {3.6965708007178183`*^9, 3.6965708129147987`*^9}, {
   3.696570849410984*^9, 3.696570913089188*^9}, {3.6965710235940313`*^9, 
   3.696571046540888*^9}, {3.6965710984834747`*^9, 3.696571104691636*^9}, {
   3.696571161631578*^9, 3.6965712533220873`*^9}, {3.696571309550762*^9, 
   3.696571327003026*^9}, {3.696571554592568*^9, 3.6965715565091*^9}, {
   3.696571671810484*^9, 3.696571678014125*^9}, {3.6965717081010036`*^9, 
   3.69657170957939*^9}, {3.69657174405055*^9, 3.696571759167459*^9}, {
   3.696571793739711*^9, 3.6965718099649563`*^9}, {3.6966552232050037`*^9, 
   3.6966552233910847`*^9}, 3.696655958604546*^9, {3.696656028511496*^9, 
   3.696656030567284*^9}, {3.696656111317144*^9, 3.696656125737125*^9}, 
   3.696656288736418*^9, 3.7059525075051107`*^9, 3.705958982407292*^9, {
   3.705969520146883*^9, 3.705969539719226*^9}, {3.705969674145084*^9, 
   3.705969674841353*^9}, {3.705969707841083*^9, 3.705969730601185*^9}, {
   3.705970444669248*^9, 3.7059704452512007`*^9}, {3.705971994716896*^9, 
   3.7059719965831757`*^9}, {3.7059720381375113`*^9, 3.705972047409801*^9}, {
   3.705979337450089*^9, 3.7059793380505543`*^9}, {3.705979500833091*^9, 
   3.7059795280341682`*^9}, {3.705979678963587*^9, 3.705979690281817*^9}, {
   3.705979817592434*^9, 3.7059798517189407`*^9}, {3.705980158295033*^9, 
   3.705980169598209*^9}, {3.7059802396614037`*^9, 3.705980239854175*^9}, {
   3.7059802833020678`*^9, 3.705980311741756*^9}, {3.705987903808641*^9, 
   3.705987906945806*^9}, {3.705987949406393*^9, 3.705987950075987*^9}, {
   3.705989077563292*^9, 3.7059890971474953`*^9}, {3.7059943301716413`*^9, 
   3.705994333872849*^9}, {3.706001016066557*^9, 3.70600106650259*^9}, {
   3.7060011343293343`*^9, 3.706001154812231*^9}, {3.706001242460485*^9, 
   3.706001242682806*^9}, {3.7060043548027763`*^9, 3.706004394183483*^9}, 
   3.706004764375546*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`time$$ = 1., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`time$$], 0, 1}}, Typeset`size$$ = {
    360., {155., 159.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`time$64388$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`time$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`time$$, $CellContext`time$64388$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        Graphics[{Black, 
          
          ReplaceAll[$CellContext`Graphicshand, $CellContext`t -> \
$CellContext`time$$], Black, 
          
          ReplaceAll[$CellContext`Graphicsball, $CellContext`t -> \
$CellContext`time$$], Black, 
          
          ReplaceAll[$CellContext`Graphicsballline, $CellContext`t -> \
$CellContext`time$$], 
          
          ReplaceAll[$CellContext`Graphicscontact, $CellContext`t -> \
$CellContext`time$$]}], Axes -> True], 
      "Specifications" :> {{$CellContext`time$$, 0, 1, AnimationRunning -> 
         False, AnimationRate -> 1., 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{405., {191., 197.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7059934288304243`*^9, 3.705993743535164*^9, 3.7059938828967037`*^9, 
   3.7059940071492357`*^9, 3.705994097589568*^9, 3.7059941359950333`*^9, 
   3.7059941679061193`*^9, 3.705994277668998*^9, {3.705994337637479*^9, 
   3.705994347804599*^9}, 3.705994388053628*^9, 3.70599442178408*^9, 
   3.705994722758029*^9, 3.705994787379805*^9, 3.705994936263764*^9, 
   3.705995010099465*^9, 3.705995134299429*^9, 3.705995690420886*^9, 
   3.7059965131438313`*^9, 3.7059971052154093`*^9, 3.7059971762243843`*^9, 
   3.705997249855685*^9, 3.70599829737808*^9, 3.705999284280714*^9, {
   3.705999842214304*^9, 3.7059998650721893`*^9}, 3.706000166195896*^9, 
   3.706000318954423*^9, 3.706000769678234*^9, 3.7060008011888866`*^9, {
   3.706001072958172*^9, 3.706001092340487*^9}, 3.706001174697165*^9, {
   3.706001350608526*^9, 3.7060013606652107`*^9}, 3.706001436371306*^9, 
   3.706001525368635*^9, 3.706002546409738*^9, 3.706004403219221*^9, 
   3.706004484143848*^9, 3.706004600145712*^9, {3.7060047705102987`*^9, 
   3.7060047807968082`*^9}, {3.706004948686569*^9, 3.706004954164504*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimizing Control (Balancing Ball)", "Section",
 CellChangeTimes->{{3.7059715295290737`*^9, 3.7059715385903254`*^9}, {
  3.705971798285685*^9, 3.70597181647888*^9}, {3.705974282085191*^9, 
  3.7059742901999617`*^9}, {3.7059795783521852`*^9, 3.7059795950080547`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Constants", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"g", "=", "9.81"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"tMax", " ", "-", " ", "0.1"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Control", " ", "Dynamics"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"x", ",", 
     RowBox[{"y", " ", "correspond", " ", "to", " ", "ball"}], ",", " ", 
     RowBox[{"\[Theta]", " ", "corresponds", " ", "to", " ", "bar"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "'"}], "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"y", "'"}], "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dX", "=", 
     RowBox[{"D", "[", 
      RowBox[{"X", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"wristAccel", "[", "t", "]"}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xd", "[", "t_", "]"}], ":=", 
     RowBox[{"0", "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yd", "[", "t_", "]"}], ":=", 
     RowBox[{"0", "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]d", "[", "t_", "]"}], ":=", 
     RowBox[{"0", "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dxd", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Theta]d", "[", "t", "]"}], ",", "t"}], "]"}], "//", 
      "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dyd", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Theta]d", "[", "t", "]"}], ",", "t"}], "]"}], "//", 
      "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d\[Theta]d", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[Theta]d", "[", "t", "]"}], ",", "t"}], "]"}], "//", 
      "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Xd", "[", "t_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xd", "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"yd", "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]d", "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dxd", "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dyd", "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"d\[Theta]d", "[", "t", "]"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"ODE", " ", "for", " ", "state", " ", "evolution"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x_", ",", "u_"}], "]"}], ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{"4", ",", "1"}], "]"}], "]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{"5", ",", "1"}], "]"}], "]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{"6", ",", "1"}], "]"}], "]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ELtemp", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ELtemp", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ELtemp", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3", ",", "2"}], "]"}], "]"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Cost", " ", "Function", " ", "Stuff"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["Q", "r"], "=", 
      RowBox[{
       SubscriptBox["Q", "n"], "=", 
       RowBox[{"Q", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"100", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "100"}], "}"}]}], "}"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["R", "r"], "=", 
      RowBox[{
       SubscriptBox["R", "n"], "=", 
       RowBox[{"R", "=", 
        RowBox[{"{", 
         RowBox[{"{", "0.001", "}"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["P1", "r"], "=", 
      RowBox[{
       SubscriptBox["P1", "n"], "=", 
       RowBox[{"P1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Qval", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rval", "=", 
     SuperscriptBox["10", "3"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P1val", "=", 
     SuperscriptBox["10", "0"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["Q", "r"], "=", 
     RowBox[{
      SubscriptBox["Q", "n"], "=", 
      RowBox[{"Q", "=", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
         "Qval", ",", "Qval", ",", "Qval", ",", "Qval", ",", "Qval", ",", 
          "Qval"}], "}"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["R", "r"], "=", 
     RowBox[{
      SubscriptBox["R", "n"], "=", 
      RowBox[{"R", "=", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", "Rval", "}"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["P1", "r"], "=", 
     RowBox[{
      SubscriptBox["P1", "n"], "=", 
      RowBox[{"P1", "=", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
         "P1val", ",", "P1val", ",", "P1val", ",", "P1val", ",", "P1val", ",",
           "P1val"}], "}"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"L", "[", 
      RowBox[{"X_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"X", "-", 
            RowBox[{"Xd", "[", "t", "]"}]}], ")"}], "\[Transpose]"}], ".", 
         "Q", ".", 
         RowBox[{"(", 
          RowBox[{"X", "-", 
           RowBox[{"Xd", "[", "t", "]"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{
        RowBox[{"U", "\[Transpose]"}], ".", "R", ".", "U"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"J", "[", 
      RowBox[{"X_", ",", "U_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Quiet", "[", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"L", "[", 
          RowBox[{"X", ",", "U"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}], 
           "}"}]}]}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"1", "/", "2"}], 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"X", "-", 
             RowBox[{"Xd", "[", "t", "]"}]}], ")"}], "/.", 
           RowBox[{"t", "\[Rule]", "T"}]}], ")"}], "\[Transpose]"}], ".", 
        "P1", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"X", "-", "Xd"}], ")"}], "/.", 
          RowBox[{"t", "\[Rule]", "T"}]}], ")"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DJzeta", "[", 
      RowBox[{"xi_", ",", "zeta_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "=", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"U", "=", 
          RowBox[{"xi", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"z", "=", 
          RowBox[{"zeta", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"v", "=", 
          RowBox[{"zeta", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Q", ".", 
                   RowBox[{"(", 
                    RowBox[{"X", "-", 
                    RowBox[{"Xd", "[", "t", "]"}]}], ")"}]}], ")"}], 
                 "\[Transpose]"}], ".", "z"}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"R", ".", "U"}], ")"}], "\[Transpose]"}], ".", 
                "v"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", 
                 RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}],
                 "}"}]}]}], "]"}], "]"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"P1", ".", 
                RowBox[{"(", 
                 RowBox[{"X", "-", 
                  RowBox[{"Xd", "[", "t", "]"}]}], ")"}]}], ")"}], 
              "\[Transpose]"}], ".", "z"}], ")"}]}], "/.", 
          RowBox[{"t", "\[Rule]", "T"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["xibar", "0"], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xd", "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["xi", "0"], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "0", "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "0", "}"}], "}"}]}], "}"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["xi", "0"], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["P1", "r"], "=", 
     RowBox[{
      SubscriptBox["P1", "n"], "=", 
      RowBox[{"P1", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "6"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Symbolic", " ", "Helpers"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Asym", "=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f", "[", 
         RowBox[{"X", ",", "U"}], "]"}], ")"}], ",", 
       RowBox[{"X", "\[Transpose]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bsym", "=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"X", ",", "U"}], "]"}], ",", 
       RowBox[{"U", "\[Transpose]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"asym", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"X", ",", "U"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "1"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"bsym", "=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"L", "[", 
         RowBox[{"X", ",", "U"}], "]"}], ",", "U"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Transform", " ", "A", " ", "and", " ", "B", " ", "to", " ", "the", " ", 
     "proper", " ", "size"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ta", "[", "R_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "X"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Control", " ", "Related", " ", "Functions"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Riccati", " ", "solution", " ", "for", " ", "P"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psol", "[", 
      RowBox[{"A_", ",", "B_", ",", "Q_", ",", "R_", ",", "P1_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"PEQ1", ",", "PEQ2", ",", "Ps", ",", "i", ",", "j"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Ri", "[", "t_", "]"}], ":=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["P", 
             RowBox[{"i", ",", "j"}]], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "@", "X"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "@", "X"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PEQ1", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Ri", "'"}], "[", "t", "]"}], "+", 
            RowBox[{
             RowBox[{"A", "\[Transpose]"}], ".", 
             RowBox[{"Ri", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Ri", "[", "t", "]"}], ".", "A"}], "-", 
            RowBox[{
             RowBox[{"Ri", "[", "t", "]"}], ".", "B", ".", 
             RowBox[{"Inverse", "[", "R", "]"}], ".", 
             RowBox[{"B", "\[Transpose]"}], ".", 
             RowBox[{"Ri", "[", "t", "]"}]}], "+", "Q"}], ")"}], "\[Equal]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Length", "@", "X"}], ",", 
              RowBox[{"Length", "@", "X"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PEQ2", "=", 
         RowBox[{
          RowBox[{"Ri", "[", "T", "]"}], "\[Equal]", "P1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ps", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"NDSolve", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"PEQ1", ",", "PEQ2"}], "}"}], ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Ri", "[", "t", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ri", "[", "t", "]"}], "/.", "Ps"}], ")"}], "]"}], ";"}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Riccati", " ", "solution", " ", "for", " ", "r"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rsol", "[", 
      RowBox[{
      "A_", ",", "B_", ",", "a_", ",", "b_", ",", "P_", ",", "R_", ",", 
       "P1_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rEQ1", ",", "rEQ2", ",", "rs"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"todo", " ", 
         RowBox[{"later", ":", " ", 
          RowBox[{
          "make", " ", "this", " ", "robust", " ", "to", " ", "different", 
           " ", "sizes"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Rir", "[", "t_", "]"}], ":=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["r", "i"], "[", "t", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "X"}]}], "}"}]}], "]"}]}], ";"}], "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Rir", "[", "t_", "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"r1", "[", "t", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"r2", "[", "t", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"r3", "[", "t", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"r4", "[", "t", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"r5", "[", "t", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"r6", "[", "t", "]"}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rEQ1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Rir", "'"}], "[", "t", "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"A", "-", 
               RowBox[{"B", ".", 
                RowBox[{"Inverse", "[", "R", "]"}], ".", 
                RowBox[{"B", "\[Transpose]"}], ".", "P"}]}], ")"}], 
             "\[Transpose]"}], ".", 
            RowBox[{"Rir", "[", "t", "]"}]}], "+", "a", "-", 
           RowBox[{"P", ".", "B", ".", 
            RowBox[{"Inverse", "[", "R", "]"}], ".", "b"}]}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"rEQ1", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Rir", "'"}], "[", "t", "]"}], "+", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"A", "-", 
                 RowBox[{"B", ".", 
                  RowBox[{"Inverse", "[", "R", "]"}], ".", 
                  RowBox[{"B", "\[Transpose]"}], ".", "P"}]}], ")"}], 
               "\[Transpose]"}], ".", 
              RowBox[{"Rir", "[", "t", "]"}]}], "+", "a", "-", 
             RowBox[{"P", ".", "B", ".", 
              RowBox[{"Inverse", "[", "R", "]"}], ".", "b"}]}], "\[Equal]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Length", "@", "X"}], ",", "1"}], "}"}]}], "]"}]}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"rEQ2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Rir", "[", "T", "]"}], "\[Equal]", 
           RowBox[{"(", 
            RowBox[{"P1", ".", 
             RowBox[{"(", 
              RowBox[{"X", "-", 
               RowBox[{"Xd", "[", "t", "]"}]}], ")"}]}], ")"}]}], "/.", 
          RowBox[{"t", "\[Rule]", "T"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rs", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"NDSolve", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rEQ1", ",", "rEQ2"}], "}"}], ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Rir", "[", "t", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"todo", ":", " ", 
          RowBox[{
          "debug", " ", "this", " ", "problem", " ", "when", " ", "P1", " ", 
           "is", " ", "given", " ", "value"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<X = \>\"", ",", "X"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Xd[t] = \>\"", ",", 
            RowBox[{"Xd", "[", "t", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<rEQ2 = \>\"", ",", "rEQ2"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Rir", "[", "t", "]"}], "/.", "rs"}], ")"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Descent", " ", "direction", " ", "solution"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zsol", "[", 
      RowBox[{"A_", ",", "B_", ",", "b_", ",", "P_", ",", "r_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "v", ",", "zEQ1", ",", "zEQ2", ",", "zs", ",", "zMat", ",", "dzMat"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"todo", ":", " ", 
         RowBox[{
         "make", " ", "this", " ", "robust", " ", "to", " ", "different", " ",
           "sizes"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"zMat", "[", "t_", "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"z1", "[", "t", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z2", "[", "t", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z3", "[", "t", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z4", "[", "t", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z5", "[", "t", "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z6", "[", "t", "]"}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dzMat", "[", "t_", "]"}], ":=", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"zMat", "[", "t", "]"}], ",", "t"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"v", "=", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            SubscriptBox["R", "n"], "]"}], ".", 
           RowBox[{"(", 
            RowBox[{"b", "+", 
             RowBox[{
              RowBox[{"B", "\[Transpose]"}], ".", "P", ".", 
              RowBox[{"zMat", "[", "t", "]"}]}], "+", 
             RowBox[{
              RowBox[{"B", "\[Transpose]"}], ".", "r"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"zEQ1", "=", 
         RowBox[{
          RowBox[{"dzMat", "[", "t", "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{"A", ".", 
            RowBox[{"zMat", "[", "t", "]"}]}], "+", 
           RowBox[{"B", ".", "v"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zEQ2", "=", 
         RowBox[{
          RowBox[{"zMat", "[", "0", "]"}], "\[Equal]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Length", "@", "X"}], ",", "1"}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"zs", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"NDSolve", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zEQ1", ",", "zEQ2"}], "}"}], ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"dzMat", "[", "t", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"z1", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"z2", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"z3", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"z4", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"z5", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"z6", "[", "t", "]"}], "}"}]}], "}"}], "/.", "zs"}], 
          ")"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Projection", " ", "of", " ", "xibar", " ", "onto", " ", "feasible", " ", 
     "space"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Proj", "[", 
      RowBox[{"xibar_", ",", "K_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"xbar", "=", 
          RowBox[{"xibar", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"ubar", "=", 
          RowBox[{"xibar", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "xEQ1", ",", "xEQ2", ",", 
         "xs"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"TODO", " ", 
         RowBox[{"later", ":", " ", 
          RowBox[{
          "update", " ", "this", " ", "to", " ", "accomodate", " ", 
           "variable", " ", 
           RowBox[{"state", "/", "control"}], " ", "spaces"}]}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"xEQ1", "=", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"dX", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"X", ",", "U"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"wristAccel", "[", "t", "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ubar", "+", 
                    RowBox[{"K", ".", 
                    RowBox[{"(", 
                    RowBox[{"X", "-", "xbar"}], ")"}]}]}], ")"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}], "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dX", "[", 
              RowBox[{"[", "5", "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"X", ",", "U"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"wristAccel", "[", "t", "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ubar", "+", 
                    RowBox[{"K", ".", 
                    RowBox[{"(", 
                    RowBox[{"X", "-", "xbar"}], ")"}]}]}], ")"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"dX", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"X", ",", "U"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"wristAccel", "[", "t", "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"ubar", "+", 
                    RowBox[{"K", ".", 
                    RowBox[{"(", 
                    RowBox[{"X", "-", "xbar"}], ")"}]}]}], ")"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}], "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
           "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xEQ1", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"dX", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"dX", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", 
            RowBox[{"dX", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "}"}], "\[Equal]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"X", ",", "U"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"wristAccel", "[", "t", "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ubar", "+", 
                   RowBox[{"K", ".", 
                    RowBox[{"(", 
                    RowBox[{"X", "-", "xbar"}], ")"}]}]}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"X", ",", "U"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"wristAccel", "[", "t", "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ubar", "+", 
                   RowBox[{"K", ".", 
                    RowBox[{"(", 
                    RowBox[{"X", "-", "xbar"}], ")"}]}]}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"X", ",", "U"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"wristAccel", "[", "t", "]"}], "\[Rule]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ubar", "+", 
                   RowBox[{"K", ".", 
                    RowBox[{"(", 
                    RowBox[{"X", "-", "xbar"}], ")"}]}]}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], ")"}], "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "\[IndentingNewLine]", 
           "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"xEQ2", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", "[", "0", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", "[", "0", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", "[", "0", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "'"}], "[", "0", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"y", "'"}], "[", "0", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "}"}]}], "}"}], 
          "\[Equal]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"xs", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"NDSolve", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"xEQ1", ",", "xEQ2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
                 RowBox[{
                  RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"xs", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"NDSolve", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"xEQ1", ",", "xEQ2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "[", "t", "]"}], ",", 
               RowBox[{"y", "[", "t", "]"}], ",", 
               RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
               RowBox[{
                SuperscriptBox["x", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], ",", 
               RowBox[{
                SuperscriptBox["y", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], ",", 
               RowBox[{
                SuperscriptBox["\[Theta]", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<xEQ1 = \>\"", ",", "xEQ1"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<xEQ2 = \>\"", ",", "xEQ2"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"(", 
          RowBox[{"X", "/.", "xs"}], ")"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Armijo", " ", "line", " ", "search"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Armijo", "[", 
      RowBox[{"xi_", ",", "xibar_", ",", "zeta_", ",", "K_", ",", 
       RowBox[{"maxIters_:", "100"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]", "=", "0.0001"}], ",", 
         RowBox[{"\[Beta]", "=", "0.5"}], ",", 
         RowBox[{"n", "=", "0"}], ",", "xibarn", ",", "\[Gamma]", ",", "X", 
         ",", "U", ",", "Xn", ",", "Un"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"X", "=", 
         RowBox[{"xi", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"U", "=", 
         RowBox[{"xi", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]", "=", 
         SuperscriptBox["\[Beta]", "n"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xibarn", "=", 
         RowBox[{"xibar", "+", 
          RowBox[{"\[Gamma]", "*", "zeta"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Xn", "=", 
         RowBox[{"Proj", "[", 
          RowBox[{"xibarn", ",", "K"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Un", "=", 
         RowBox[{
          RowBox[{"xibarn", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"K", ".", 
           RowBox[{"(", 
            RowBox[{"Xn", "-", 
             RowBox[{"xibarn", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"J", "[", 
                RowBox[{"Xn", ",", "Un"}], "]"}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ">", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"J", "[", 
                 RowBox[{"X", ",", "U"}], "]"}], "+", 
                RowBox[{"\[Alpha]", "*", "\[Gamma]", "*", 
                 RowBox[{"DJzeta", "[", 
                  RowBox[{"xi", ",", "zeta"}], "]"}]}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"n", "<", "maxIters"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n", "=", 
            RowBox[{"n", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Gamma]", "=", 
            SuperscriptBox["\[Beta]", "n"]}], ";", "\[IndentingNewLine]", 
           RowBox[{"xibarn", "=", 
            RowBox[{"xibar", "+", 
             RowBox[{"\[Gamma]", "*", "zeta"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Xn", "=", 
            RowBox[{"Proj", "[", 
             RowBox[{"xibarn", ",", "K"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Un", "=", 
            RowBox[{
             RowBox[{"xibarn", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", 
             RowBox[{"K", ".", 
              RowBox[{"(", 
               RowBox[{"Xn", "-", 
                RowBox[{"xibar", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"xibarn", ",", 
           RowBox[{"{", 
            RowBox[{"Xn", ",", "Un"}], "}"}]}], "}"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Alogrithm", " ", "Loop"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}], "**********************************************)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["norm", "0"], "=", "100"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{"And", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          SubscriptBox["norm", "i"], "]"}], ">", "\[Epsilon]"}], ",", 
        RowBox[{"i", "<", "30"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"TODO", ":", " ", 
        RowBox[{"update", " ", "for", " ", "balancing", " ", "problem"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["A", "i"], ",", 
          SubscriptBox["B", "i"], ",", 
          SubscriptBox["a", "i"], ",", 
          SubscriptBox["b", "i"]}], "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ta", "[", "Asym", "]"}], ",", 
           RowBox[{"Ta", "[", "Bsym", "]"}], ",", "asym", ",", "bsym"}], 
          "}"}], "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "t", "]"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["xi", "i"], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"y", "[", "t", "]"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["xi", "i"], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["xi", "i"], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "'"}], "[", "t", "]"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["xi", "i"], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "4", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"y", "'"}], "[", "t", "]"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["xi", "i"], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "5", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["xi", "i"], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "6", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"wristAccel", "[", "t", "]"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["xi", "i"], "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["Pn", "i"], "=", 
        RowBox[{"Psol", "[", 
         RowBox[{
          SubscriptBox["A", "i"], ",", 
          SubscriptBox["B", "i"], ",", 
          SubscriptBox["Q", "n"], ",", 
          SubscriptBox["R", "n"], ",", 
          SubscriptBox["P1", "n"]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["r", "i"], "=", 
        RowBox[{"rsol", "[", 
         RowBox[{
          SubscriptBox["A", "i"], ",", 
          SubscriptBox["B", "i"], ",", 
          SubscriptBox["a", "i"], ",", 
          SubscriptBox["b", "i"], ",", 
          SubscriptBox["Pn", "i"], ",", 
          SubscriptBox["R", "n"], ",", 
          SubscriptBox["P1", "n"]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["z", "i"], "=", 
        RowBox[{"zsol", "[", 
         RowBox[{
          SubscriptBox["A", "i"], ",", 
          SubscriptBox["B", "i"], ",", 
          SubscriptBox["b", "i"], ",", 
          SubscriptBox["Pn", "i"], ",", 
          SubscriptBox["r", "i"]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["v", "i"], "=", 
        RowBox[{"-", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           SubscriptBox["R", "n"], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["b", "i"], "+", 
            RowBox[{
             RowBox[{
              SubscriptBox["B", "i"], "\[Transpose]"}], ".", 
             SubscriptBox["Pn", "i"], ".", 
             SubscriptBox["z", "i"]}], "+", 
            RowBox[{
             RowBox[{
              SubscriptBox["B", "i"], "\[Transpose]"}], ".", 
             SubscriptBox["r", "i"]}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["zeta", "i"], "=", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["z", "i"], ",", 
          SubscriptBox["v", "i"]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["Pr", "i"], "=", 
        RowBox[{"Psol", "[", 
         RowBox[{
          SubscriptBox["A", "i"], ",", 
          SubscriptBox["B", "i"], ",", 
          SubscriptBox["Q", "r"], ",", 
          SubscriptBox["R", "r"], ",", 
          SubscriptBox["P1", "r"]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Kappa]", "i"], "=", 
        RowBox[{"-", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           SubscriptBox["R", "r"], "]"}], ".", 
          RowBox[{
           SubscriptBox["B", "i"], "\[Transpose]"}], ".", 
          SubscriptBox["Pr", "i"]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["xibar", 
           RowBox[{"i", "+", "1"}]], ",", 
          SubscriptBox["xi", 
           RowBox[{"i", "+", "1"}]]}], "}"}], "=", 
        RowBox[{"Armijo", "[", 
         RowBox[{
          SubscriptBox["xi", "i"], ",", 
          SubscriptBox["xibar", "i"], ",", 
          SubscriptBox["zeta", "i"], ",", 
          SubscriptBox["\[Kappa]", "i"]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["norm", 
         RowBox[{"i", "+", "1"}]], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"DJzeta", "[", 
           RowBox[{
            SubscriptBox["xi", "i"], ",", 
            SubscriptBox["zeta", "i"]}], "]"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"i", "=", 
        RowBox[{"i", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.705971607907093*^9, 3.70597166297626*^9}, {
   3.705971704264621*^9, 3.705971704294797*^9}, 3.705971754411347*^9, {
   3.7059717913632183`*^9, 3.705971791494128*^9}, {3.705971825004105*^9, 
   3.705971858977214*^9}, {3.705971909755518*^9, 3.705971909915262*^9}, 
   3.705972121847933*^9, {3.7059722705808496`*^9, 3.705972284938553*^9}, {
   3.7059723582827787`*^9, 3.7059725138077707`*^9}, 3.705972558054356*^9, {
   3.705972611183743*^9, 3.705972696011407*^9}, {3.705972749679356*^9, 
   3.705972767775182*^9}, {3.7059728058771257`*^9, 3.705972840417495*^9}, {
   3.705972881749449*^9, 3.705972899363909*^9}, {3.705980394322568*^9, 
   3.7059804472246237`*^9}, {3.705980540597002*^9, 3.705980545774108*^9}, {
   3.7059807821551228`*^9, 3.705980805477098*^9}, {3.705980838788269*^9, 
   3.7059808708411837`*^9}, {3.705980909178897*^9, 3.705980945666656*^9}, {
   3.705981001129345*^9, 3.70598108378548*^9}, {3.705981229473682*^9, 
   3.7059812531875963`*^9}, {3.7059813403978977`*^9, 3.70598140313431*^9}, {
   3.705981468222827*^9, 3.7059814710242167`*^9}, {3.705981508501402*^9, 
   3.7059815373118362`*^9}, {3.7059816395406313`*^9, 3.705981642848239*^9}, {
   3.7059817539583273`*^9, 3.705981796811503*^9}, {3.7059818727569532`*^9, 
   3.70598187296799*^9}, {3.70598192221284*^9, 3.705981969180216*^9}, {
   3.7059823025014668`*^9, 3.705982343226481*^9}, {3.705982590418528*^9, 
   3.705982594986977*^9}, {3.70598278261723*^9, 3.705982846596382*^9}, {
   3.705983008750132*^9, 3.705983019449595*^9}, {3.705983078037388*^9, 
   3.705983142367424*^9}, {3.705983293066154*^9, 3.705983320683989*^9}, {
   3.705983453154056*^9, 3.705983521087161*^9}, {3.7059836315444527`*^9, 
   3.705983641460699*^9}, {3.705983693685993*^9, 3.705983705513698*^9}, {
   3.7059838235796432`*^9, 3.705983847828993*^9}, 3.705983921606599*^9, {
   3.705983988292633*^9, 3.705983991234528*^9}, {3.7059840986239033`*^9, 
   3.705984098662887*^9}, {3.705984282635254*^9, 3.705984284171001*^9}, {
   3.7059844014523993`*^9, 3.705984410442168*^9}, {3.7059847016712*^9, 
   3.705984831219884*^9}, {3.705984936863352*^9, 3.705984941221767*^9}, {
   3.7059850316006517`*^9, 3.705985034294527*^9}, {3.705985120371999*^9, 
   3.705985127073299*^9}, {3.7059852298507957`*^9, 3.7059852394269114`*^9}, {
   3.705985339704714*^9, 3.705985394495363*^9}, {3.705985516993052*^9, 
   3.705985519866887*^9}, {3.705987642336442*^9, 3.705987700571707*^9}, {
   3.7059880530090227`*^9, 3.7059880532321377`*^9}, {3.705988117263187*^9, 
   3.7059881571570377`*^9}, {3.705988208338373*^9, 3.705988237253338*^9}, {
   3.705988269699441*^9, 3.705988369856744*^9}, {3.70598840896292*^9, 
   3.705988424499734*^9}, {3.705988459045643*^9, 3.705988469725449*^9}, {
   3.705988502252349*^9, 3.705988502698567*^9}, {3.705988552754408*^9, 
   3.705988625463039*^9}, {3.7059886785191*^9, 3.705988704316053*^9}, {
   3.705988750696418*^9, 3.705988806570545*^9}, {3.705988865990281*^9, 
   3.7059888674854937`*^9}, {3.705988969369787*^9, 3.705988969645401*^9}, {
   3.7059891373764353`*^9, 3.705989245604939*^9}, {3.705989290797537*^9, 
   3.705989362068893*^9}, {3.705989438436528*^9, 3.705989475584337*^9}, {
   3.705989540826233*^9, 3.705989797104117*^9}, {3.705989850527014*^9, 
   3.705989879574806*^9}, {3.7059899449392242`*^9, 3.7059900084526052`*^9}, {
   3.705990074840105*^9, 3.705990076553753*^9}, {3.705990145514497*^9, 
   3.705990148702252*^9}, {3.705990376167919*^9, 3.705990571447544*^9}, 
   3.7059906384224777`*^9, {3.705990681942876*^9, 3.705990698204938*^9}, {
   3.705990765101651*^9, 3.7059910187803383`*^9}, {3.705991077948544*^9, 
   3.7059910840794773`*^9}, {3.705991163128666*^9, 3.705991166197474*^9}, {
   3.705991356426321*^9, 3.705991362872055*^9}, 3.705991408598634*^9, {
   3.7059915504861917`*^9, 3.705991551552312*^9}, {3.705991583470662*^9, 
   3.7059916114318867`*^9}, {3.705991667976737*^9, 3.7059916680211487`*^9}, {
   3.705991722449133*^9, 3.705991725034297*^9}, {3.705991877538056*^9, 
   3.7059918809886217`*^9}, 3.705991947845893*^9, {3.705992045535532*^9, 
   3.705992060537003*^9}, {3.705992129088167*^9, 3.705992345744197*^9}, {
   3.705992456868395*^9, 3.705992539353202*^9}, {3.705992602776763*^9, 
   3.705992631520701*^9}, {3.705993115145123*^9, 3.705993123180575*^9}, {
   3.705993444262731*^9, 3.705993450550848*^9}, {3.705993491599359*^9, 
   3.705993514025672*^9}, {3.705993548113163*^9, 3.7059935867796507`*^9}, {
   3.705993680436849*^9, 3.705993706975377*^9}, {3.7059938096655083`*^9, 
   3.705993837465469*^9}, {3.705993951190711*^9, 3.705993997736693*^9}, {
   3.705994379752646*^9, 3.7059943799264*^9}, {3.70599459960564*^9, 
   3.705994601199239*^9}, {3.705994687249357*^9, 3.705994708448204*^9}, {
   3.705994776217388*^9, 3.7059947765472116`*^9}, {3.705994897523922*^9, 
   3.705994919407658*^9}, {3.705994974302758*^9, 3.7059949925133467`*^9}, 
   3.70599508719541*^9, {3.705995119254637*^9, 3.7059951243798428`*^9}, {
   3.7059952225477247`*^9, 3.705995291718649*^9}, 3.70599542500278*^9, {
   3.7059955866830997`*^9, 3.7059956293122807`*^9}, 3.705995672026004*^9, {
   3.705995900466926*^9, 3.705995901912054*^9}, {3.705995971581788*^9, 
   3.7059959746674213`*^9}, {3.705996124869192*^9, 3.705996130342783*^9}, {
   3.705996254843185*^9, 3.705996255165073*^9}, {3.705996316450851*^9, 
   3.705996327653265*^9}, {3.70599642945576*^9, 3.7059964296393957`*^9}, {
   3.705996669513145*^9, 3.705996702562585*^9}, {3.705996751357378*^9, 
   3.7059967540842876`*^9}, {3.70599688270811*^9, 3.705996883051053*^9}, {
   3.705996927033778*^9, 3.705996932652163*^9}, {3.705996970957045*^9, 
   3.705996971286356*^9}, {3.705997075246504*^9, 3.7059970958778677`*^9}, {
   3.705997130148677*^9, 3.705997159429014*^9}, {3.705997216388937*^9, 
   3.705997228914407*^9}, {3.70599730075497*^9, 3.7059973389260473`*^9}, {
   3.7059973950456657`*^9, 3.705997408478302*^9}, {3.705997454898324*^9, 
   3.7059974657155113`*^9}, {3.7059975235895433`*^9, 3.7059976012269*^9}, {
   3.705997866231929*^9, 3.705997880688312*^9}, {3.705997980365418*^9, 
   3.705998022922361*^9}, {3.705998054881139*^9, 3.705998077622767*^9}, {
   3.705998280514296*^9, 3.705998287188937*^9}, {3.7059984785363894`*^9, 
   3.705998478694523*^9}, {3.705998572559024*^9, 3.7059986678666773`*^9}, {
   3.705998816122386*^9, 3.705998840245183*^9}, {3.7059989583443747`*^9, 
   3.705998977575838*^9}, {3.705999150506288*^9, 3.705999202223399*^9}, {
   3.705999256589038*^9, 3.705999381681788*^9}, {3.7059994170924463`*^9, 
   3.705999420304303*^9}, {3.7059995189694653`*^9, 3.705999519355348*^9}, {
   3.705999727060383*^9, 3.7059997662470427`*^9}, {3.705999799776215*^9, 
   3.705999828536734*^9}, {3.705999993209323*^9, 3.705999993768154*^9}, {
   3.7060000264499197`*^9, 3.706000132445034*^9}, {3.7060001899553432`*^9, 
   3.706000219349811*^9}, {3.706000370572342*^9, 3.706000382497677*^9}, {
   3.706000412795035*^9, 3.706000412964876*^9}, {3.7060008101096497`*^9, 
   3.706000810418417*^9}, {3.7060010453567038`*^9, 3.706001046393847*^9}, {
   3.706003874622417*^9, 3.706003887016593*^9}, {3.706003929992684*^9, 
   3.706003932398222*^9}, {3.7060040083312674`*^9, 3.7060040262468977`*^9}, {
   3.706004631413151*^9, 3.706004639866149*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plots And Animation", "Section",
 CellChangeTimes->{{3.706003859221615*^9, 3.7060038641156597`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xsol", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["xi", "i"], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ysol", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["xi", "i"], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]wristsol", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["xi", "i"], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Plot", " ", "trajectories", " ", "and", " ", "control", " ", "effort"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Plot", "[", 
    RowBox[{
     SubscriptBox["xi", "i"], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["xi", "i"], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Dynamic", " ", "coords", " ", "and", " ", "graphics"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordball", "[", "time_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"gball", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"gball", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]wrist", "[", "t", "]"}], "\[Rule]", 
         "\[Theta]wristsol"}], ",", 
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], "\[Rule]", "xsol"}], ",", 
        RowBox[{
         RowBox[{"y", "[", "t", "]"}], "\[Rule]", "ysol"}], ",", 
        RowBox[{
         RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]sol"}]}], 
       "}"}]}], ")"}], "/.", 
    RowBox[{"t", "\[Rule]", "time"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Graphicsball", " ", "=", " ", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"coordball", "[", "t", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"coordball", "[", "t", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "rball"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Black", ",", 
        RowBox[{"Graphicshand", "/.", 
         RowBox[{"t", "\[Rule]", "time"}]}], ",", "\[IndentingNewLine]", 
        "Black", ",", 
        RowBox[{"Graphicsball", "/.", 
         RowBox[{"t", "\[Rule]", "time"}]}]}], "\[IndentingNewLine]", "}"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"time", ",", "troll", ",", "tRelease"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AnimationRate", "\[Rule]", "1.0"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.706000385519006*^9, 3.706000419099319*^9}, {
   3.706000451658411*^9, 3.7060004767063093`*^9}, {3.706000515614492*^9, 
   3.706000515717599*^9}, {3.706000687630137*^9, 3.706000707516293*^9}, {
   3.7060007530849733`*^9, 3.706000755729967*^9}, {3.706000845906063*^9, 
   3.7060008649028873`*^9}, {3.7060013014634037`*^9, 3.706001301624547*^9}, {
   3.70600139464739*^9, 3.7060014199982*^9}, 3.7060027114027*^9, {
   3.7060038664790783`*^9, 3.706003868610506*^9}, {3.706004671424232*^9, 
   3.706004695733947*^9}, {3.706004728733008*^9, 3.706004729376683*^9}, {
   3.7060048910173683`*^9, 3.706004906258555*^9}, {3.706005206029571*^9, 
   3.706005206752686*^9}, 3.7060052473260593`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.706005208699994*^9, 3.706005208727231*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.706005210006179*^9, 3.706005210033669*^9}}],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.706005241464759*^9, 3.706005241487281*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`time$$ = 1., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`time$$], 0, 1}}, Typeset`size$$ = {
    360., {170., 174.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`time$56012$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`time$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`time$$, $CellContext`time$56012$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        Graphics[{Black, 
          
          ReplaceAll[$CellContext`Graphicshand, $CellContext`t -> \
$CellContext`time$$], Black, 
          
          ReplaceAll[$CellContext`Graphicsball, $CellContext`t -> \
$CellContext`time$$]}], PlotRange -> {{1, 2.5}, {-0.5, 1}}, Axes -> True], 
      "Specifications" :> {{$CellContext`time$$, 0, 1, AnimationRunning -> 
         False, AnimationRate -> 1., 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{405., {206., 212.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.706000744755611*^9, 3.706000827965921*^9, 3.7060008667520847`*^9, 
   3.706001422098452*^9, 3.7060015120024633`*^9, 3.7060027001991777`*^9, 
   3.7060038913752403`*^9, 3.7060044513487787`*^9, {3.706004648366972*^9, 
   3.7060046963224*^9}, 3.706004741083205*^9, 3.706004907489674*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1035},
WindowMargins->{{Automatic, -292}, {796, Automatic}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 342, 7, 148, "Title"],
Cell[925, 31, 313, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[1263, 41, 458, 6, 64, "Section"],
Cell[CellGroupData[{
Cell[1746, 51, 42465, 1005, 2807, "Input"],
Cell[44214, 1058, 5254, 76, 24, "Message"],
Cell[49471, 1136, 6065, 86, 42, "Output"],
Cell[55539, 1224, 9164, 149, 231, "Output"],
Cell[64706, 1375, 8163, 134, 225, "Output"],
Cell[72872, 1511, 8269, 132, 459, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81190, 1649, 338, 6, 64, "Section"],
Cell[CellGroupData[{
Cell[81553, 1659, 55745, 1206, 2511, "Input"],
Cell[137301, 2867, 3475, 67, 405, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[140825, 2940, 273, 3, 64, "Section"],
Cell[141101, 2945, 56724, 1441, 3911, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197862, 4391, 106, 1, 64, "Section"],
Cell[197971, 4394, 5136, 140, 537, "Input"],
Cell[203110, 4536, 92, 1, 32, InheritFromParent],
Cell[203205, 4539, 92, 1, 32, InheritFromParent],
Cell[CellGroupData[{
Cell[203322, 4544, 92, 1, 32, InheritFromParent],
Cell[203417, 4547, 2497, 50, 435, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

